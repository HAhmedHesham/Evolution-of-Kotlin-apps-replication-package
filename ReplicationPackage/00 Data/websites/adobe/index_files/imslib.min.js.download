var roll=function(){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};function t(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return(r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function n(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function o(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function i(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}var a,s=function(){function e(){this.data={},this.length=0}return e.prototype.clear=function(){this.data={},this.length=0},e.prototype.getItem=function(e){var t=this.data[e];return t||null},e.prototype.removeItem=function(e){return!!this.data[e]&&(delete this.data[e],--this.length,!0)},e.prototype.setItem=function(e,t){this.data[e]||++this.length,this.data[e]=t},e.prototype.key=function(e){throw new Error("Method not implemented. "+e)},e}();!function(e){e.LocalStorage="local",e.SessionStorage="session",e.MemoryStorage="memory"}(a||(a={}));var c,u="Authorization",l=new(function(){function e(){var e=this;this.logEnabled=!1,this.print=function(t,r){e.logEnabled&&t.apply(void 0,i(r))},this.assert=function(t,r){e.print(console.assert,[t,r])},this.assertCondition=function(t,r){t()||e.print(console.error,[r])},this.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e.print(console.error,t)},this.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e.print(console.warn,t)},this.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e.print(console.info,t)}}return e.prototype.enableLogging=function(){this.logEnabled=!0},e.prototype.disableLogging=function(){this.logEnabled=!1},e}()),p=new(function(){function e(){this.memoryStorageInstance=null}return Object.defineProperty(e.prototype,"memoryStorage",{get:function(){return this.memoryStorageInstance||(this.memoryStorageInstance=new s),this.memoryStorageInstance},enumerable:!0,configurable:!0}),e.prototype.getStorageByName=function(e){var t=this.getStorageInstanceByName(e);return t&&this.verifyStorage(t)?t:this.memoryStorage},e.prototype.getStorageInstanceByName=function(e){if(e===a.MemoryStorage)return this.memoryStorage;try{return e===a.LocalStorage?window.localStorage:window.sessionStorage}catch(e){return l.warn("Please change your cookies settings in order to allow local data to be set"),null}},e.prototype.getAvailableStorage=function(){var e=this.getStorageByName(a.LocalStorage);return e instanceof s?this.getStorageByName(a.SessionStorage):e},e.prototype.verifyStorage=function(e){try{return e.setItem("test","true"),"true"===e.getItem("test")&&(e.removeItem("test"),!0)}catch(e){return!1}},e}()),f=function(){function e(e){this.storageInstance=null,this.nonceStorageKey="",this.nonceStorageKey="nonce"+e}return Object.defineProperty(e.prototype,"storage",{get:function(){return this.storageInstance||(this.storageInstance=p.getAvailableStorage()),this.storageInstance},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){if(!this.isStorageAvailable())return"";var t=e.generateNonce(),r=this.getNonceFromStorage()||{};return r=this.clearOlderNonceKeys(r),this.addNonceToObject(r,t),this.saveNonceValuesToStorage(r),t.value},e.prototype.addNonceToObject=function(e,t){e[t.value]=t.expiry},e.prototype.clearOlderNonceKeys=function(e,t){void 0===t&&(t=1296e4);var r=Date.now()-t;return Object.keys(e).forEach((function(t){parseInt(e[t])<r&&delete e[t]})),e},e.prototype.verify=function(e){if(!this.isStorageAvailable())return!0;var t=this.getNonceFromStorage();if(!t)return!1;var r=this.clearOlderNonceKeys(t),n=null!==(r[e]||null);return n&&this.clearNonceValueFromStorage(r,e),n},e.prototype.clearNonceValueFromStorage=function(e,t){delete e[t],this.saveNonceValuesToStorage(e)},e.prototype.getNonceFromStorage=function(){var e=this.storage.getItem(this.nonceStorageKey);return e?JSON.parse(e):null},e.prototype.saveNonceValuesToStorage=function(e){this.storage.setItem(this.nonceStorageKey,JSON.stringify(e))},e.prototype.isStorageAvailable=function(){return!(this.storage instanceof s)},e.cryptoRndomString=function(){if(!window.crypto)return"";var e=new Uint32Array(3);return window.crypto.getRandomValues(e),e.join("").substr(0,16)},e.randomString=function(){var t=e.cryptoRndomString();if(t)return t;for(var r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<16;o++)r+=n.charAt(Math.floor(Math.random()*n.length));return r},e.generateNonce=function(){return{value:e.randomString(),expiry:(new Date).getTime().toString()}},e}(),d=new(function(){function e(){}return e.prototype.uriEncodeData=function(e){if("object"!=typeof e)return"";var t,r=[],n="";for(var o in e)void 0!==(t=e[o])&&(n=this.encodeValue(t),r.push(encodeURIComponent(o)+"="+n));return r.join("&")},e.prototype.encodeValue=function(e){return null===e?"null":"object"==typeof e?encodeURIComponent(JSON.stringify(e)):encodeURIComponent(e)},e.prototype.replaceUrl=function(e){e&&window.location.replace(e)},e.prototype.setHrefUrl=function(e){e&&(window.location.href=e)},e.prototype.setHash=function(e){void 0===e&&(e=""),window.location.hash=e},e}());!function(e){e.STAGE="stg1",e.PROD="prod"}(c||(c={}));var h=new(function(){function e(){this.baseUrlAdobe="",this.baseUrlServices="",this.jslibver="v2-v0.19.0-2-ga9be19e"}return e.prototype.loadEnvironment=function(e){if(e===c.STAGE)return this.baseUrlAdobe="https://ims-na1-stg1.adobelogin.com",void(this.baseUrlServices="https://adobeid-na1-stg1.services.adobe.com");this.baseUrlAdobe="https://ims-na1.adobelogin.com",this.baseUrlServices="https://adobeid-na1.services.adobe.com"},e}());var v=function(){this.__data__=[],this.size=0};var g=function(e,t){return e===t||e!=e&&t!=t};var m=function(e,t){for(var r=e.length;r--;)if(g(e[r][0],t))return r;return-1},y=Array.prototype.splice;var _=function(e){var t=this.__data__,r=m(t,e);return!(r<0)&&(r==t.length-1?t.pop():y.call(t,r,1),--this.size,!0)};var b=function(e){var t=this.__data__,r=m(t,e);return r<0?void 0:t[r][1]};var w=function(e){return m(this.__data__,e)>-1};var k=function(e,t){var r=this.__data__,n=m(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function S(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}S.prototype.clear=v,S.prototype.delete=_,S.prototype.get=b,S.prototype.has=w,S.prototype.set=k;var I=S;var R=function(){this.__data__=new I,this.size=0};var P=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var T=function(e){return this.__data__.get(e)};var j=function(e){return this.__data__.has(e)},A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function O(e,t){return e(t={exports:{}},t.exports),t.exports}var E="object"==typeof A&&A&&A.Object===Object&&A,x="object"==typeof self&&self&&self.Object===Object&&self,U=E||x||Function("return this")(),F=U.Symbol,D=Object.prototype,z=D.hasOwnProperty,C=D.toString,V=F?F.toStringTag:void 0;var N=function(e){var t=z.call(e,V),r=e[V];try{e[V]=void 0;var n=!0}catch(e){}var o=C.call(e);return n&&(t?e[V]=r:delete e[V]),o},L=Object.prototype.toString;var M=function(e){return L.call(e)},q=F?F.toStringTag:void 0;var H=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":q&&q in Object(e)?N(e):M(e)};var J=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var K,B=function(e){if(!J(e))return!1;var t=H(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},G=U["__core-js_shared__"],W=(K=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||""))?"Symbol(src)_1."+K:"";var $=function(e){return!!W&&W in e},X=Function.prototype.toString;var Z=function(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Q=/^\[object .+?Constructor\]$/,Y=Function.prototype,ee=Object.prototype,te=Y.toString,re=ee.hasOwnProperty,ne=RegExp("^"+te.call(re).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var oe=function(e){return!(!J(e)||$(e))&&(B(e)?ne:Q).test(Z(e))};var ie=function(e,t){return null==e?void 0:e[t]};var ae=function(e,t){var r=ie(e,t);return oe(r)?r:void 0},se=ae(U,"Map"),ce=ae(Object,"create");var ue=function(){this.__data__=ce?ce(null):{},this.size=0};var le=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},pe=Object.prototype.hasOwnProperty;var fe=function(e){var t=this.__data__;if(ce){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return pe.call(t,e)?t[e]:void 0},de=Object.prototype.hasOwnProperty;var he=function(e){var t=this.__data__;return ce?void 0!==t[e]:de.call(t,e)};var ve=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ce&&void 0===t?"__lodash_hash_undefined__":t,this};function ge(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ge.prototype.clear=ue,ge.prototype.delete=le,ge.prototype.get=fe,ge.prototype.has=he,ge.prototype.set=ve;var me=ge;var ye=function(){this.size=0,this.__data__={hash:new me,map:new(se||I),string:new me}};var _e=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var be=function(e,t){var r=e.__data__;return _e(t)?r["string"==typeof t?"string":"hash"]:r.map};var we=function(e){var t=be(this,e).delete(e);return this.size-=t?1:0,t};var ke=function(e){return be(this,e).get(e)};var Se=function(e){return be(this,e).has(e)};var Ie=function(e,t){var r=be(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Re(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Re.prototype.clear=ye,Re.prototype.delete=we,Re.prototype.get=ke,Re.prototype.has=Se,Re.prototype.set=Ie;var Pe=Re;var Te=function(e,t){var r=this.__data__;if(r instanceof I){var n=r.__data__;if(!se||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Pe(n)}return r.set(e,t),this.size=r.size,this};function je(e){var t=this.__data__=new I(e);this.size=t.size}je.prototype.clear=R,je.prototype.delete=P,je.prototype.get=T,je.prototype.has=j,je.prototype.set=Te;var Ae=je,Oe=function(){try{var e=ae(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Ee=function(e,t,r){"__proto__"==t&&Oe?Oe(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var xe=function(e,t,r){(void 0===r||g(e[t],r))&&(void 0!==r||t in e)||Ee(e,t,r)};var Ue=function(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),s=a.length;s--;){var c=a[e?s:++o];if(!1===r(i[c],c,i))break}return t}}(),Fe=O((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?U.Buffer:void 0,i=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=i?i(r):new e.constructor(r);return e.copy(n),n}})),De=U.Uint8Array;var ze=function(e){var t=new e.constructor(e.byteLength);return new De(t).set(new De(e)),t};var Ce=function(e,t){var r=t?ze(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)};var Ve=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},Ne=Object.create,Le=function(){function e(){}return function(t){if(!J(t))return{};if(Ne)return Ne(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var Me=function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object),qe=Object.prototype;var He=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||qe)};var Je=function(e){return"function"!=typeof e.constructor||He(e)?{}:Le(Me(e))};var Ke=function(e){return null!=e&&"object"==typeof e};var Be=function(e){return Ke(e)&&"[object Arguments]"==H(e)},Ge=Object.prototype,We=Ge.hasOwnProperty,$e=Ge.propertyIsEnumerable,Xe=Be(function(){return arguments}())?Be:function(e){return Ke(e)&&We.call(e,"callee")&&!$e.call(e,"callee")},Ze=Array.isArray;var Qe=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Ye=function(e){return null!=e&&Qe(e.length)&&!B(e)};var et=function(e){return Ke(e)&&Ye(e)};var tt=function(){return!1},rt=O((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?U.Buffer:void 0,i=(o?o.isBuffer:void 0)||tt;e.exports=i})),nt=Function.prototype,ot=Object.prototype,it=nt.toString,at=ot.hasOwnProperty,st=it.call(Object);var ct=function(e){if(!Ke(e)||"[object Object]"!=H(e))return!1;var t=Me(e);if(null===t)return!0;var r=at.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&it.call(r)==st},ut={};ut["[object Float32Array]"]=ut["[object Float64Array]"]=ut["[object Int8Array]"]=ut["[object Int16Array]"]=ut["[object Int32Array]"]=ut["[object Uint8Array]"]=ut["[object Uint8ClampedArray]"]=ut["[object Uint16Array]"]=ut["[object Uint32Array]"]=!0,ut["[object Arguments]"]=ut["[object Array]"]=ut["[object ArrayBuffer]"]=ut["[object Boolean]"]=ut["[object DataView]"]=ut["[object Date]"]=ut["[object Error]"]=ut["[object Function]"]=ut["[object Map]"]=ut["[object Number]"]=ut["[object Object]"]=ut["[object RegExp]"]=ut["[object Set]"]=ut["[object String]"]=ut["[object WeakMap]"]=!1;var lt=function(e){return Ke(e)&&Qe(e.length)&&!!ut[H(e)]};var pt=function(e){return function(t){return e(t)}},ft=O((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r&&E.process,i=function(){try{var e=n&&n.require&&n.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=i})),dt=ft&&ft.isTypedArray,ht=dt?pt(dt):lt;var vt=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},gt=Object.prototype.hasOwnProperty;var mt=function(e,t,r){var n=e[t];gt.call(e,t)&&g(n,r)&&(void 0!==r||t in e)||Ee(e,t,r)};var yt=function(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],c=n?n(r[s],e[s],s,r,e):void 0;void 0===c&&(c=e[s]),o?Ee(r,s,c):mt(r,s,c)}return r};var _t=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},bt=/^(?:0|[1-9]\d*)$/;var wt=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&bt.test(e))&&e>-1&&e%1==0&&e<t},kt=Object.prototype.hasOwnProperty;var St=function(e,t){var r=Ze(e),n=!r&&Xe(e),o=!r&&!n&&rt(e),i=!r&&!n&&!o&&ht(e),a=r||n||o||i,s=a?_t(e.length,String):[],c=s.length;for(var u in e)!t&&!kt.call(e,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||wt(u,c))||s.push(u);return s};var It=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},Rt=Object.prototype.hasOwnProperty;var Pt=function(e){if(!J(e))return It(e);var t=He(e),r=[];for(var n in e)("constructor"!=n||!t&&Rt.call(e,n))&&r.push(n);return r};var Tt=function(e){return Ye(e)?St(e,!0):Pt(e)};var jt=function(e){return yt(e,Tt(e))};var At=function(e,t,r,n,o,i,a){var s=vt(e,r),c=vt(t,r),u=a.get(c);if(u)xe(e,r,u);else{var l=i?i(s,c,r+"",e,t,a):void 0,p=void 0===l;if(p){var f=Ze(c),d=!f&&rt(c),h=!f&&!d&&ht(c);l=c,f||d||h?Ze(s)?l=s:et(s)?l=Ve(s):d?(p=!1,l=Fe(c,!0)):h?(p=!1,l=Ce(c,!0)):l=[]:ct(c)||Xe(c)?(l=s,Xe(s)?l=jt(s):J(s)&&!B(s)||(l=Je(c))):p=!1}p&&(a.set(c,l),o(l,c,n,i,a),a.delete(c)),xe(e,r,l)}};var Ot=function e(t,r,n,o,i){t!==r&&Ue(r,(function(a,s){if(i||(i=new Ae),J(a))At(t,r,s,n,e,o,i);else{var c=o?o(vt(t,s),a,s+"",t,r,i):void 0;void 0===c&&(c=a),xe(t,s,c)}}),Tt)};var Et=function(e){return e};var xt=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Ut=Math.max;var Ft=function(e,t,r){return t=Ut(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=Ut(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(a),xt(e,this,s)}};var Dt=function(e){return function(){return e}},zt=Oe?function(e,t){return Oe(e,"toString",{configurable:!0,enumerable:!1,value:Dt(t),writable:!0})}:Et,Ct=Date.now;var Vt=function(e){var t=0,r=0;return function(){var n=Ct(),o=16-(n-r);if(r=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(zt);var Nt=function(e,t){return Vt(Ft(e,t,Et),e+"")};var Lt=function(e,t,r){if(!J(r))return!1;var n=typeof t;return!!("number"==n?Ye(r)&&wt(t,r.length):"string"==n&&t in r)&&g(r[t],e)};var Mt,qt,Ht=function(e){return Nt((function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&Lt(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,i)}return t}))}((function(e,t,r){Ot(e,t,r)})),Jt=new(function(){function e(){this.getCustomApiParameters=function(e,t){return e[t]||{}}}return e.prototype.mergeExternalParameters=function(e,t,r){return Ht(this.getCustomApiParameters(t,r),e)},e.prototype.toJson=function(e){try{return"string"!=typeof e?e:JSON.parse(e)}catch(e){return null}},e}()),Kt=function(){function e(){}return e.getInitialRedirectUri=function(e,t){var r=e.redirect_uri||t||window.location.href,n=r.indexOf("from_ims");return-1===n?r:("#"===r[n-1]&&n--,r.substr(0,n))},e.createDefaultRedirectUrl=function(e,t,r,n){var o=this.getInitialRedirectUri(r,e),i=this.createOldHash(o);return i.indexOf("?")>0?i+"&client_id="+t+"&api="+n:i+"?client_id="+t+"&api="+n},e.createRedirectUrl=function(e,t,r,n,o){void 0===o&&(o="");var i=this.createDefaultRedirectUrl(e,t,r,n);(o=o||r.scope||"")&&(i=i+"&scope="+o);var a=r.reauth||"";return a&&(i=i+"&reauth="+a),i},e.createOldHash=function(e){var t=e.indexOf("#");return t<0?e+"#old_hash=&from_ims=true":e.substring(0,t)+"#old_hash="+e.substring(t+1)+"&from_ims=true"},e.mergeApiParamsWithExternalParams=function(e,t,r){return Ht(Jt.getCustomApiParameters(e,r),t)},e}(),Bt=function(){var e=this;this.composeRedirectUrl=function(e){var t=e.apiParameters,n=e.externalParameters,o=void 0===n?{}:n,i=e.adobeIdRedirectUri,a=void 0===i?"":i,s=e.clientId,c=e.locale,u=e.state,l=void 0===u?{}:u,p=e.scope,f=void 0===p?o.scope||t.scope||"":p,d=Kt.mergeApiParamsWithExternalParams(t,o,"authorize");l&&(d.state=Ht(d.state||{},l));var v=Kt.createRedirectUrl(a,s,d,"authorize",f),g=o.locale||c||"",m=e.response_type,y=void 0===m?d.response_type||"":m;return r(r({},d),{client_id:s,scope:f,locale:g,response_type:y,jslVersion:h.jslibver,redirect_uri:v})},this.createRedirectUrl=function(t){var r=e.composeRedirectUrl(t),n=d.uriEncodeData(r);return h.baseUrlAdobe+"/ims/authorize/v1?"+n}},Gt=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.signIn=function(e){var r=t.createRedirectUrl(e);d.setHrefUrl(r)},t.authorizeToken=function(e,r){var n=t.composeRedirectUrl(r);e&&(n.user_assertion=e,n.user_assertion_type="urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),t.createAuthorizeForm(n).submit()},t}return t(r,e),r.prototype.createAuthorizeForm=function(e){var t=h.baseUrlAdobe+"/ims/authorize/v1",r=document.createElement("form");r.setAttribute("method","post"),r.setAttribute("action",t);var n=null,o=null,i="";for(var a in e){if("object"==typeof(o=e[a])){if(0===Object.keys(o).length)continue;i=JSON.stringify(o)}else i=o;""!==i&&(n=this.createFormElement("input","text",a,i),r.appendChild(n))}return document.getElementsByTagName("body")[0].appendChild(r),r},r.prototype.createFormElement=function(e,t,r,n){var o=document.createElement(e);return o.setAttribute("type",t),o.setAttribute("name",r),o.setAttribute("value",n),o},r}(Bt),Wt=new function(){var e=this;this.windowObjectReference=null,this.previousUrl="",this.openSignInWindow=function(t,r,n,o){e.onProcessLocation=o,e.timerId&&clearInterval(e.timerId),window.removeEventListener("message",e.receiveMessage),window.addEventListener("message",e.receiveMessage);var i="toolbar=no, menubar=no, width="+n.width+", height="+n.height+", top="+n.top+", left="+n.left;!e.windowObjectReference||e.windowObjectReference&&e.windowObjectReference.closed?e.windowObjectReference=window.open(t,n.title,i):e.previousUrl!==t?(e.windowObjectReference=window.open(t,n.title,i),e.windowObjectReference&&e.windowObjectReference.focus()):e.windowObjectReference.focus();var a=e.windowObjectReference||{};a.opener||(e.timerId=setInterval((function(){a[r]&&(clearInterval(e.timerId),e.onProcessLocation&&e.onProcessLocation(a[r]),delete a[r],e.windowObjectReference&&e.windowObjectReference.close())}),500)),e.previousUrl=t},this.receiveMessage=function(t){e.onProcessLocation&&e.onProcessLocation(t.data)}},$t=function(e){function n(t,n){var o=e.call(this)||this;return o.signIn=function(e){e.state=r(r({},e.state),{imslibmodal:!0});var t=e.state.nonce,n=o.createRedirectUrl(e);Wt.openSignInWindow(n,t,o.popupSettings,o.onPopupMessage)},o.onPopupMessage=t,o.popupSettings=n,o}return t(n,e),n}(Bt),Xt=function(){this.signOut=function(e){var t=e.apiParameters,n=e.externalParameters,o=e.adobeIdRedirectUri,i=void 0===o?"":o,a=e.clientId,s=Kt.mergeApiParamsWithExternalParams(t,n,"logout"),c=Kt.createDefaultRedirectUrl(i,a,s,"logout"),u=r(r({},s),{client_id:a,redirect_uri:c,jslVersion:h.jslibver}),l=d.uriEncodeData(u),p=h.baseUrlAdobe+"/ims/logout/v1?"+l;d.replaceUrl(p)}},Zt=function(e){void 0===e&&(e={}),this.title="Adobe ID",this.width=600,this.top=100,this.left=100;var t=e.title,r=void 0===t?"Adobe ID":t,n=e.width,o=void 0===n?600:n,i=e.height,a=void 0===i?700:i,s=e.top,c=void 0===s?100:s,u=e.left,l=void 0===u?100:u;this.title=r,this.width=o,this.height=a,this.top=c,this.left=l},Qt=function(e){this.token="",this.sid="",this.expirems=0;var t=e.token,r=e.expirems;this.token=t,this.expirems=r};!function(e){e.force="force",e.check="check"}(Mt||(Mt={})),function(e){e.token="token",e.code="code"}(qt||(qt={}));var Yt,er=function(){this.appCode="",this.appVersion=""},tr=function(){function e(){this.storage=p.getAvailableStorage()}return e.prototype.b64Uri=function(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},e.prototype.createCodeChallenge=function(e,t){var r=this;void 0===t&&(t=43);for(var n=window.msCrypto||window.crypto,o=this.b64Uri(Array.prototype.map.call(n.getRandomValues(new Uint8Array(t)),(function(e){return String.fromCharCode(e)})).join("")).substring(0,t),a=new Uint8Array(o.length),s=0;s<o.length;s++)a[s]=o.charCodeAt(s);var c=n.subtle.digest("SHA-256",a);return new Promise((function(t,n){window.CryptoOperation?(c.onerror=function(e){return n(e)},c.oncomplete=function(n){var a=new Uint8Array(n.target.result),s=r.b64Uri(String.fromCharCode.apply(String,i(a)));return t(r.saveVerifierAndReturn(e,{verifier:o,challenge:s}))}):c.then((function(n){var a=new Uint8Array(n),s=r.b64Uri(String.fromCharCode.apply(String,i(a)));return t(r.saveVerifierAndReturn(e,{verifier:o,challenge:s}))}))}))},e.prototype.saveVerifierAndReturn=function(e,t){var r=this.getVerifierValuesFromStorage(),n={verifier:t.verifier||"",expiry:(new Date).getTime().toString()};return r[e]=n,this.storage.setItem("verifiers",JSON.stringify(r)),Promise.resolve(t)},e.prototype.getVerifierValuesFromStorage=function(){var e=this.storage.getItem("verifiers"),t=e?JSON.parse(e):{};return this.clearOlderVerifiers(t)},e.prototype.clearOlderVerifiers=function(e,t){void 0===t&&(t=1296e4);var r=Date.now()-t;return Object.keys(e).forEach((function(t){parseInt(e[t])<r&&delete e[t]})),e},e.prototype.getVerifierByKey=function(e){var t=this.getVerifierValuesFromStorage(),r=t?t[e]:{};return delete t[e],this.storage.setItem("verifiers",JSON.stringify(t)),r?r.verifier:""},e}(),rr=function(e){function n(t){void 0===t&&(t=null);var r=e.call(this,t)||this;r.onAccessTokenHasExpired=null,r.onAccessToken=null,r.onReauthAccessToken=null,r.onError=null,r.handlers={triggerOnAccessToken:function(e){r.onAccessToken&&r.onAccessToken(e)},triggerOnReauthAccessToken:function(e){r.onReauthAccessToken&&r.onReauthAccessToken(e)},triggerOnAccessTokenHasExpired:function(){r.onAccessTokenHasExpired&&r.onAccessTokenHasExpired()},triggerOnReady:function(e){void 0===e&&(e=null),r.onReady&&r.onReady(e)},triggerOnError:function(e,t){r.onError&&r.onError(e,t)}};var n=t||window.adobeid;if(!n)throw new Error("Please provide adobeId information");var o=n.standalone,i=n.autoValidateToken,a=n.modalSettings,s=void 0===a?{}:a,c=n.modalMode,u=void 0!==c&&c,l=n.onAccessToken,p=n.onReauthAccessToken,f=n.onAccessTokenHasExpired,d=n.onReady,h=n.onError;return o&&o.token&&(r.standalone=new Qt(o)),r.modalSettings=new Zt(s),r.modalMode=u,r.autoValidateToken=!!i,r.onAccessToken=l||null,r.onReauthAccessToken=p||null,r.onAccessTokenHasExpired=f||null,r.onReady=d||null,r.onError=h||null,r}return t(n,e),n.prototype.createSocialProviderRedirectRequest=function(e,t,n,o,i){void 0===i&&(i=qt.token);var a={idp_flow:"social.deep_link.web",provider_id:e},s=r(r({},t),a);return this.createRedirectRequest(s,n,o,i)},n.prototype.createReAuthenticateRedirectRequest=function(e,t,n,o,i){void 0===o&&(o=Mt.check),void 0===i&&(i=qt.token);var a={reauth:o},s=r(r({},e),a);return this.createRedirectRequest(s,t,n,i)},n.prototype.createSignUpRedirectRequest=function(e,t,n,o){void 0===o&&(o=qt.token);var i=r(r({},e),{idp_flow:"create_account"});return this.createRedirectRequest(i,t,n,o)},n}(function(){function e(e){void 0===e&&(e=null),this.analyticsParameters=new er,this.api_parameters={},this.locale="",this.scope="AdobeID",this.client_id="",this.environment=c.PROD,this.useLocalStorage=!1,this.onReady=null;var t=e||window.adobeid;if(!t)throw new Error("Please provide adobeId information");var r=t.api_parameters,n=t.client_id,o=t.locale,i=t.scope,a=t.ijt,s=t.environment,u=void 0===s?c.PROD:s,p=t.redirect_uri,f=t.useLocalStorage,d=t.logsEnabled,v=t.onReady;this.environment=u,this.api_parameters=r||{},this.client_id=n,this.locale=o||"en_US",this.scope=i?i.replace(/\s/gi,""):"",this.redirect_uri=p,this.ijt=a,this.useLocalStorage=f,d?l.enableLogging():l.disableLogging(),this.onReady=v||null,this.fillAnalityticsParameters(t),h.loadEnvironment(u)}return e.prototype.fillAnalityticsParameters=function(e){var t=e.analytics,r=void 0===t?{}:t,n=r.appCode,o=void 0===n?"":n,i=r.appVersion,a=void 0===i?"":i,s=this.analyticsParameters;s.appCode=o,s.appVersion=a},e.prototype.createSocialProviderRedirectRequest=function(e,t,n,o,i){var a={idp_flow:"social.deep_link.web",provider_id:e},s=r(r({},t),a);return this.createRedirectRequest(s,n,o,i)},e.prototype.createReAuthenticateRedirectRequest=function(e,t,n,o,i){void 0===o&&(o=Mt.check),void 0===i&&(i=qt.token);var a={reauth:o},s=r(r({},e),a);return this.createRedirectRequest(s,t,n,i)},e.prototype.createSignUpRedirectRequest=function(e,t,n){var o=r(r({},e),{idp_flow:"create_account"});return this.createRedirectRequest(o,t,n,qt.token)},e.prototype.createRedirectRequest=function(e,t,r,n){var o=this,i=this,a=i.api_parameters,s=void 0===a?{}:a,c=i.client_id,u=i.redirect_uri,l=void 0===u?"":u,p=i.scope,f=i.locale,d=this.createRedirectState(t,r),h={adobeIdRedirectUri:l,apiParameters:s,clientId:c,externalParameters:e,scope:p,locale:f,response_type:n,state:d};return n===qt.token?Promise.resolve(h):(new tr).createCodeChallenge(r).then((function(n){e.code_challenge=n.challenge,e.code_challenge_method="S256";var i=o.createRedirectState(t,r);return h.state=i,Promise.resolve(h)}))},e.prototype.createRedirectState=function(e,t){var r=this.analyticsParameters,n=r.appCode,o=void 0===n?"":n,i=r.appVersion,a=void 0===i?"":i,s=void 0===e?{}:{context:e};return o&&(s.ac=o),a&&(s.av=a),s.jslibver=h.jslibver,s.nonce=t,Object.keys(s).length?s:null},e.prototype.triggerOnReady=function(){this.onReady&&this.onReady(void 0)},e}()),nr=new(function(){function e(){var e=this;this.DEBOUNCE_TIME=1e3,this.cache={},this.storeApiResponse=function(t,r,n){void 0===t&&(t=""),void 0===r&&(r=""),e.cacheApiResponse(t,r,n)}}return e.prototype.getCachedApiResponse=function(e,t){void 0===t&&(t="");var r="string"==typeof t?t:JSON.stringify(t),n=this.cache[e];if(!n)return null;var o=n[r];return o?o.data:null},e.prototype.cacheApiResponse=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t="");var o=this.cache[e];o||(o={},this.cache[e]=o);var i=this.createClearCachedDataTimer(e,t);o[t]={timerId:i,data:r({},n)}},e.prototype.createClearCachedDataTimer=function(e,t){var r=this;return setTimeout((function(){var n=r.cache[e]||{},o=n[t];o&&o&&o.timerId&&(clearTimeout(o.timerId),delete n[t])}),this.DEBOUNCE_TIME)},e}()),or=function(e,t){this.jump="",this.code=e,this.jump=t},ir=function(e){var t=e.error,r=e.retryAfter,n=void 0===r?0:r,o=e.message,i=void 0===o?"":o;this.error=t,this.retryAfter=n,this.message=i},ar=new(function(){function e(){}return e.prototype.verify=function(e){var t=e.status,r=e.data;if(!t)return new ir({error:"networkError",message:r||""});if(401==t)return new ir({error:"unauthorized"});var n=this.parseTokenResponseForRideErrors(r);return n||(409==t?r:429==t?new ir({error:"rate_limited",retryAfter:r.retryAfter?parseInt(r.retryAfter):10}):t.toString().match(/5\d{2}/g)?new ir({error:"server_error"}):null)},e.prototype.parseTokenResponseForRideErrors=function(e){if(!e)return null;var t=e.error,r=e.jump;return t&&0===t.indexOf("ride_")?new or(t,r||""):null},e.prototype.isUnauthorizedException=function(e){var t=e.status;return 401===(void 0===t?0:t)},e}()),sr=function(){function e(e,t){this.status=0,this.data="",this.status=e,this.data=this.toJson(t)}return e.prototype.toJson=function(e){try{return"string"!=typeof e?e:JSON.parse(e)}catch(t){return e}},e}(),cr=new(function(){function e(){}return e.prototype.http=function(e){return new Promise((function(t,r){var n=new(0,window.XMLHttpRequest);n.withCredentials=!0,n.open(e.method,e.url,!0);var o;n.onload=function(){return this.status>=200&&this.status<300?t(new sr(this.status,this.response)):r(new sr(this.status,this.response))},n.onerror=function(){var e=new sr(this.status,this.response);return r(e)},(o=e.headers)&&Object.keys(o).forEach((function(e){n.setRequestHeader(e,o[e])})),n.send(e.data)}))},e.prototype.post=function(e,t,r){return void 0===r&&(r={}),this.http({headers:r,method:"POST",url:e,data:t})},e.prototype.get=function(e,t){return void 0===t&&(t={}),this.http({headers:t,method:"GET",url:e})},e}()),ur=new(function(){function e(){this.triggerOnError=null}return e.prototype.post=function(e,t,r){var n=this;void 0===r&&(r={});var o=nr.getCachedApiResponse(e,t);if(o){var i=o.status,a=o.data;return 200===i?Promise.resolve(a):Promise.reject(a)}return cr.post(e,t,r).then((function(r){return n.storeApiResponse(e,JSON.stringify(t),r)})).catch((function(r){return n.verifyError(e,JSON.stringify(t),r)}))},e.prototype.get=function(e,t){var r=this;void 0===t&&(t={});var n=nr.getCachedApiResponse(e);if(n){var o=n.status,i=n.data;return 200===o?Promise.resolve(i):Promise.reject(i)}return cr.get(e,t).then((function(t){return r.storeApiResponse(e,"",t)})).catch((function(t){return r.verifyError(e,"",t)}))},e.prototype.verifyError=function(e,t,r){this.storeApiResponse(e,t,r);var n=ar.verify(r);return Promise.reject(n||r.data)},e.prototype.storeApiResponse=function(e,t,r){return void 0===t&&(t=""),nr.storeApiResponse(e,t,r),Promise.resolve(r.data)},e}()),lr=function(){function e(e){void 0===e&&(e={}),this.CONTENT_FORM_ENCODED="application/x-www-form-urlencoded;charset=utf-8",this.apiParameters=e}return e.prototype.validateToken=function(e){var t=e.token,n=e.client_id,o=d.uriEncodeData(r(r({},Jt.getCustomApiParameters(this.apiParameters,"validate_token")),{type:"access_token",client_id:n,token:t})),i=h.baseUrlAdobe+"/ims/validate_token/v1?jslVersion="+h.jslibver;return ur.post(i,o,this.formEncoded())},e.prototype.getProfile=function(e){var t=e.token,n=e.client_id,o=r({},Jt.getCustomApiParameters(this.apiParameters,"profile")),i=this.createAuthorizationHeader(t),a=d.uriEncodeData(r({client_id:n},o)),s=h.baseUrlAdobe+"/ims/profile/v1?"+a+"&jslVersion="+h.jslibver;return ur.get(s,i)},e.prototype.getUserInfo=function(e){var t=e.token,n=e.client_id,o=r({},Jt.getCustomApiParameters(this.apiParameters,"userinfo")),i=this.createAuthorizationHeader(t),a=d.uriEncodeData(r({client_id:n},o)),s=h.baseUrlAdobe+"/ims/userinfo/v1?"+a+"&jslVersion="+h.jslibver;return ur.get(s,i)},e.prototype.logoutToken=function(e){var t=e.client_id,n=e.token,o=r({},Jt.getCustomApiParameters(this.apiParameters,"logout_token")),i=h.baseUrlServices+"/ims/logout/v1?jslVersion="+h.jslibver;return ur.post(i,r({client_id:t,access_token:n},o))},e.prototype.checkStatus=function(){var e=h.baseUrlServices+"/ims/check/v1/status";return ur.get(e)},e.prototype.checkToken=function(e,t,n){var o=e.client_id,i=e.scope,a=r({},Jt.mergeExternalParameters(t,this.apiParameters,"check_token")),s=h.baseUrlServices+"/ims/check/v6/token?jslVersion="+h.jslibver,c=r(r({},a),{client_id:o,scope:i});n&&(c.user_id=n);var u=d.uriEncodeData(c);return ur.post(s,u,this.formEncoded())},e.prototype.switchProfile=function(e,t,n){void 0===n&&(n="");var o=e.client_id,i=e.scope,a=void 0===i?"":i,s=r({},Jt.mergeExternalParameters(t,this.apiParameters,"check_token")),c=h.baseUrlServices+"/ims/check/v6/token?jslVersion="+h.jslibver,u=d.uriEncodeData(r(r({},s),{client_id:o,scope:a,user_id:n}));return ur.post(c,u,this.formEncoded())},e.prototype.listSocialProviders=function(e){var t=e.client_id,n=r({},Jt.getCustomApiParameters(this.apiParameters,"providers")),o=d.uriEncodeData(r({client_id:t},n)),i=h.baseUrlServices+"/ims/social/v1/providers?"+o+"&jslVersion="+h.jslibver;return ur.get(i)},e.prototype.exchangeIjt=function(e,t){var n=e.client_id,o=r({},Jt.getCustomApiParameters(this.apiParameters,"ijt")),i=h.baseUrlServices+"/ims/jump/implicit/"+t,a=d.uriEncodeData(r({client_id:n},o)),s=i+"?"+a+"&jslVersion="+h.jslibver;return s.length>2048&&(delete o.redirect_uri,s=i+"?"+(a=d.uriEncodeData(o))),ur.get(s)},e.prototype.avatarUrl=function(e){return h.baseUrlAdobe+"/ims/avatar/download/"+e},e.prototype.getReleaseFlags=function(e){var t=e.token,n=e.client_id,o=r({},Jt.getCustomApiParameters(this.apiParameters,"fg_value")),i=this.createAuthorizationHeader(t),a=d.uriEncodeData(r({client_id:n},o)),s=h.baseUrlAdobe+"/ims/fg/value/v1?"+a+"&jslVersion="+h.jslibver;return ur.get(s,i)},e.prototype.getTransitoryAuthorizationCode=function(e,t,n){void 0===t&&(t={});var o=r({},Jt.mergeExternalParameters(t,this.apiParameters,"check_token")),i=h.baseUrlServices+"/ims/check/v6/token?client_id="+n+"&jslVersion="+h.jslibver,a=d.uriEncodeData(r(r({},o),e));return ur.post(i,a,this.formEncoded())},e.prototype.getTokenFromCode=function(e,t){void 0===t&&(t={});var n=r({},Jt.mergeExternalParameters(t,this.apiParameters,"token"));n.grant_type="authorization_code",delete e.other;var o=h.baseUrlServices+"/ims/token/v3?jslVersion="+h.jslibver,i=d.uriEncodeData(r(r({},n),e));return ur.post(o,i,this.formEncoded())},e.prototype.jumpToken=function(e,t,n){void 0===t&&(t={});var o=r({},Jt.mergeExternalParameters(t,this.apiParameters,"jumptoken")),i=h.baseUrlServices+"/ims/jumptoken/v1?client_id="+n+"&jslVersion="+h.jslibver,a=d.uriEncodeData(r(r({},o),e));return ur.post(i,a,this.formEncoded())},e.prototype.createAuthorizationHeader=function(e){var t={};return e&&(t[u]="Bearer "+e),t},e.prototype.formEncoded=function(e){return void 0===e&&(e={}),e["content-type"]=this.CONTENT_FORM_ENCODED,e},e}();!function(e){e.INITIALIZE_ERROR="initialize_error",e.HTTP="http",e.FRAGMENT="fragment",e.CSRF="csrf",e.NOT_AUTHORIZE="not_authorize",e.PROFILE_EXCEPTION="profile_exception",e.TOKEN_EXPIRED="token_expired",e.SOCIAL_PROVIDERS="SOCIAL_PROVIDERS",e.RIDE_EXCEPTION="ride_exception"}(Yt||(Yt={}));var pr,fr=function(e){this.message=null,this.errorType=Yt.PROFILE_EXCEPTION,this.message=e},dr=function(){function e(e){this.profileServiceRequest=e,this.storage=p.getStorageByName(a.SessionStorage)}return e.prototype.getProfile=function(e){var t=this,r=this.profileServiceRequest,n=r.clientId,o=r.imsApis,i=this.getProfileFromStorage();return i?Promise.resolve(i):o.getProfile({client_id:n,token:e}).then((function(e){if(!e)throw new fr("NO profile response");if(0===Object.keys(e).length)throw new fr("NO profile value");return t.saveProfileToStorage(e),Promise.resolve(e)})).catch((function(e){return e instanceof ir?Promise.reject(e):(t.removeProfile(),Promise.reject(e))}))},e.prototype.getProfileStorageKey=function(){var e=this.profileServiceRequest;return"adobeid_ims_profile/"+e.clientId+"/"+!1+"/"+e.scope},e.prototype.getProfileFromStorage=function(){var e=this.getProfileStorageKey(),t=this.storage.getItem(e);return t?JSON.parse(t):null},e.prototype.saveProfileToStorage=function(e){var t=this.getProfileStorageKey();this.storage.setItem(t,JSON.stringify(e))},e.prototype.removeProfile=function(){var e=this.getProfileStorageKey();this.storage.removeItem(e)},e.prototype.removeProfileIfOtherUser=function(e){if(e){var t=this.getProfileFromStorage();t&&t.userId!==e&&this.removeProfile()}},e}(),hr=function(){function e(e,t){var r=this;this.REAUTH_SCOPE="reauthenticated",this.valid=!1,this.isReauth=function(){return r.scope.indexOf(r.REAUTH_SCOPE)>=0},this.client_id="",this.scope="",this.expire=new Date,this.user_id="",this.tokenValue="",this.sid="",this.state=null,this.fromFragment=!1;var n=e.valid,o=e.tokenValue,i=e.access_token,a=e.state,s=e.other,c=o||i,u=this.parseJwt(c);if(!u)throw new Error("token cannot be decoded "+c);this.state=Jt.toJson(a);var l=u.client_id,p=u.user_id,f=u.scope,d=u.sid;this.client_id=l,this.expire=t,this.user_id=p,this.scope=f,this.valid=n,this.tokenValue=c,this.sid=d,this.other=s}return e.prototype.parseJwt=function(e){if(!e)return null;try{return JSON.parse(atob(e.split(".")[1]))}catch(t){return l.error("error on decoding token ",e,t),null}},e.prototype.validate=function(e,t){var r=this,n=this.valid,o=this.client_id,i=this.scope,a=this.expire;if(a<new Date)return l.error("token invalid  --\x3e expires_at",a),!1;if(null!=n&&!n)return l.error("token invalid  --\x3e valid"),!1;if(o!==e)return l.error("token invalid  --\x3e client id",o,e),!1;if(this.isReauth()){var s=i.split(",").filter((function(e){return e!==r.REAUTH_SCOPE})).join(",");if(s!==t)return l.error("reauth token invalid  --\x3e scope"," token scope =",s,"vs adobeIdScope =",t,"."),!1}else if(i!==t)return l.error("token invalid  --\x3e scope"," token scope =",i,"vs adobeIdScope =",t,"."),!1;return!0},e}(),vr=new(function(){function e(){}return e.prototype.fragmentToObject=function(){var e=this.getHashFromURL();if(!e)return null;var t=this.processHashUrl(e),r=this.getOldHash(t),n=r?t.slice(t.indexOf("old_hash")):t,o=this.removeOldHash(n),i=this.getQueryParamsAsMap(o);r&&(i.old_hash=r);var a=i.state;return a&&(i.state=Jt.toJson(a)),i},e.prototype.getOldHash=function(e){if(!e)return"";var t=e.match("old_hash=(.*?)&from_ims=true");return t?t[1]:""},e.prototype.removeOldHash=function(e){return e?e.replace(/old_hash=(.*?)&from_ims=true/gi,"from_ims=true"):e},e.prototype.getHashFromURL=function(e){void 0===e&&(e=window.location.href);var t=e.indexOf("#");return-1!==t?e.substring(t+1):""},e.prototype.getQueryParamsAsMap=function(e){if(!e)return{};var t={};return(e=e.replace(/^(#\/|\/|#|\?|&)/,"")).split("&").forEach((function(e){if(e.length){var r=e.split("=");t[r[0]]=decodeURIComponent(r[1])}})),t},e.prototype.processHashUrl=function(e){return e.replace("?error","#error").replace(/#/gi,"&").replace("from_ims=true?","from_ims=true&")},e}()),gr=function(e,t){this.message="",this.type="",this.type=e,this.message=t};!function(e){e.FRAGMENT="fragment",e.CSRF="csrf",e.NOT_AUTHORIZE="not_authorize"}(pr||(pr={}));var mr=function(e,t){this.profile=null,this.tokenFields=e,this.profile=t},yr=function(e){this.exception=null,this.exception=e},_r=function(e){this.client_id="",this.scope="",this.code="",this.state=null,this.code_verifier="",this.other=null;var t=e.code,r=e.state,o=e.client_id,i=e.scope,a=e.verifier,s=n(e,["code","state","client_id","scope","verifier"]);this.state=r,this.client_id=o,this.code=t,this.scope=i,this.code_verifier=a,this.other=s},br=function(e){this.wndRedirectPropName="",this.wndRedirectPropName=e},wr=function(){function e(e,t){var r=this;this.getTokenAndProfile=function(e){void 0===e&&(e={});var t=r.getTokenFields();return t instanceof br?Promise.reject(t):t instanceof gr?Promise.reject(t):t instanceof _r?r.tokenServiceRequest.imsApis.getTokenFromCode(t,e).then((function(e){var r=e.access_token,o=e.state,i=e.expires_in,a=e.scope,s=void 0===a?"":a,c=n(e,["access_token","state","expires_in","scope"]),u=new hr({scope:s,tokenValue:r,valid:!0,state:o,other:t.other},new Date((new Date).getTime()+parseFloat(i)));return Promise.resolve(new mr(u,c))})):t instanceof hr?t.fromFragment||!r.tokenServiceRequest.autoValidateToken?Promise.resolve(new mr(t,null)):r.callValidateTokenApi(t.tokenValue).then((function(){return new mr(t,null)})).catch((function(){return r.callRefreshToken(e)})):r.callRefreshToken(e)};var o=e.useLocalStorage;this.csrfService=t,this.tokenServiceRequest=e,this.storage=p.getStorageByName(o?a.LocalStorage:a.SessionStorage)}return e.prototype.getTokenFields=function(){var e=this.tokenServiceRequest,t=e.clientId,r=e.scope,n=this.getTokenFromFragment();return n instanceof br?n:n instanceof gr?n:n instanceof _r?n:n&&n.validate(t,r)?(n.fromFragment=!0,this.addTokenToStorage(n),n):this.getTokenFieldsFromStorage()},e.prototype.validateToken=function(){var e=this.getTokenFieldsFromStorage();return e?this.callValidateTokenApi(e.tokenValue):Promise.reject(null)},e.prototype.getReleaseFlags=function(){var e=this.tokenServiceRequest,t=e.clientId,r=e.imsApis,n=this.getTokenFieldsFromStorage();return n?r.getReleaseFlags({token:n.tokenValue,client_id:t}):Promise.reject(null)},e.prototype.callValidateTokenApi=function(e){var t=this,n=this.tokenServiceRequest,o=n.clientId,i=n.scope;return n.imsApis.validateToken({client_id:o,token:e}).then((function(n){l.info("validateToken response",n);var a=new hr(r(r({},n),{tokenValue:e}),new Date(parseFloat(n.expires_at)));if(a.validate(o,i))return t.addTokenToStorage(a),Promise.resolve(a);throw new Error("could not validate tokenFields")})).catch((function(e){return l.error("validateToken response",e),e instanceof ir?Promise.reject(e):(t.removeTokenFromLocalStorage(),Promise.reject(e))}))},e.prototype.getTokenFromFragment=function(){var e=vr.fragmentToObject();if(!e)return null;l.info("fragment value "+e);var t=e.access_token,o=e.scope,i=e.error,a=e.api,s=e.state,c=void 0===s?{}:s,u=e.expires_in,p=e.client_id,f=e.code,d=void 0===f?"":f,h=n(e,["access_token","scope","error","api","state","expires_in","client_id","code"]),v=c.imslibmodal,g=c.nonce;if(!0===v)return new br(g);if(!e.from_ims)return null;if(p!==this.tokenServiceRequest.clientId)return null;if(i)return new gr(pr.FRAGMENT,i);if("authorize"!==a)return new gr(pr.NOT_AUTHORIZE,"api should be authorize and "+a+" is used");if(!this.csrfService.verify(g))return new gr(pr.CSRF,"CSRF exception");if(d){var m=(new tr).getVerifierByKey(g);if(!m)throw new Error("no verifier value has been found");return new _r(r(r({},e),{verifier:m}))}return t?new hr({scope:o,tokenValue:t,valid:!0,state:c,other:h},new Date((new Date).getTime()+parseFloat(u))):null},e.prototype.getStorageKeyValue=function(e){return this.storage.getItem(e)},e.prototype.getTokenFieldsFromStorage=function(e){void 0===e&&(e=!1);var t=this.tokenServiceRequest,r=t.clientId,n=t.scope,o=this.getAccessTokenKey(e),i=this.getStorageKeyValue(o);if(!i)return null;var a=JSON.parse(i),s=a.expire?new Date(Date.parse(a.expire)):new Date(a.expiresAtMilliseconds),c=new hr(a,s);return c.validate(r,n)?c:null},e.prototype.getAccessTokenKey=function(e){void 0===e&&(e=!1);var t=this.tokenServiceRequest;return"adobeid_ims_access_token/"+t.clientId+"/"+e+"/"+t.scope},e.prototype.addTokenToStorage=function(e){if(e){var t=e.isReauth(),n=this.getAccessTokenKey(t),o=r({},e);o.state={},o.other="{}",this.storage.setItem(n,JSON.stringify(o))}},e.prototype.removeTokenFromLocalStorage=function(){var e=this.getAccessTokenKey();this.storage.removeItem(e)},e.prototype.removeReauthTokenFromLocalStorage=function(){var e=this.getAccessTokenKey(!0);this.storage.removeItem(e)},e.prototype.refreshToken=function(e){var t=this;void 0===e&&(e={});var r=this.tokenServiceRequest,o=r.clientId,i=r.imsApis,a=r.scope,s=this.getTokenFieldsFromStorage(),c=s?s.user_id:"";return i.checkToken({client_id:o,scope:a},e,c).then((function(e){if(!e)throw new Error("refresh token --\x3e no response");var r=e.access_token,o=e.expires_in,i=e.token_type,a=e.error,s=e.error_description,c=void 0===s?"":s,u=e.sid,l=n(e,["access_token","expires_in","token_type","error","error_description","sid"]);if(a)throw new Error(a+" "+c);var p=Object.keys(l).length?l:null,f={tokenInfo:{token:r,expire:new Date(Date.now()+parseFloat(o)),token_type:i,sid:u},profile:p};return t.updateToken(f.tokenInfo),Promise.resolve(f)})).catch((function(e){return void 0===e&&(e={}),e instanceof ir?Promise.reject(e):e instanceof or?Promise.reject(e):(t.removeTokenFromLocalStorage(),Promise.reject(new yr(e)))}))},e.prototype.switchProfile=function(e,t){var r=this;void 0===t&&(t={});var o=this.tokenServiceRequest,i=o.clientId,a=o.imsApis,s=o.scope;return a.switchProfile({client_id:i,scope:s},t,e).then((function(e){if(!e)throw new Error("refresh token --\x3e no response");var t=e.access_token,o=e.expires_in,i=e.token_type,a=e.error,s=e.error_description,c=void 0===s?"":s,u=e.sid,l=n(e,["access_token","expires_in","token_type","error","error_description","sid"]);if(a)throw new Error(a+" "+c);var p=Object.keys(l).length?l:null,f={tokenInfo:{token:t,expire:new Date(Date.now()+parseFloat(o)),token_type:i,sid:u},profile:p};return r.updateToken(f.tokenInfo),Promise.resolve(f)})).catch((function(e){return void 0===e&&(e={}),Promise.reject(e)}))},e.prototype.callRefreshToken=function(e){return void 0===e&&(e={}),this.refreshToken(e).then((function(e){var t=e.tokenInfo,r=t.token,n=t.expire,o=e.profile,i=new hr({valid:!0,tokenValue:r},n),a=new mr(i,o);return Promise.resolve(a)})).catch((function(e){return Promise.reject(e)}))},e.prototype.updateToken=function(e){var t=e.token,r=e.expire,n=new hr({tokenValue:t},r);n&&(n.tokenValue=t,this.addTokenToStorage(n))},e.prototype.purge=function(){this.removeTokenFromLocalStorage(),this.removeReauthTokenFromLocalStorage()},e.prototype.setStandAloneToken=function(e){var t=e.token,r=e.sid,n=e.expirems,o=void 0===n?-1:n,i=this.tokenServiceRequest,a=i.clientId,s=i.scope,c=new Date((new Date).getTime()+o);if(!new hr({valid:!0,tokenValue:t},c).validate(a,s))return!1;var u={expire:c,token:t,sid:r};return this.updateToken(u),!0},e.prototype.exchangeIjt=function(e){var t=this.tokenServiceRequest,r={client_id:t.clientId,scope:t.scope};return t.imsApis.exchangeIjt(r,e).then((function(e){var t=e.valid,r=e.access_token,n=e.expires_in;if(!1===t)return Promise.reject(e);var o=new Date(Date.now()+parseFloat(n)),i=new hr({valid:!0,tokenValue:r},o),a=new mr(i,null);return Promise.resolve(a)}))},e}(),kr=["keyup","mousemove"],Sr=new(function(){function e(){var e=this;this.autoRefreshParameters=null,this.onUserInteraction=function(){e.ignoreUserInteractionTimerId&&e.initializeRefreshTokenLastMinuteInterval()}}return e.prototype.startAutoRefreshFlow=function(e){var t=this;if(e){this.autoRefreshParameters=e;var r=e.expire;r&&(this.stopTimer(this.autoRefreshTimerId),this.autoRefreshTimerId=0,this.initializeIgnoreUserInteractionInterval(r),kr.forEach((function(e){return t.initializeDomEvent(e)})))}},e.prototype.initializeIgnoreUserInteractionInterval=function(e){var t=this;this.stopTimer(this.ignoreUserInteractionTimerId),this.ignoreUserInteractionTimerId=0;var r=this.getIgnoreUserInteractionInterval(e);this.ignoreUserInteractionTimerId=setTimeout((function(){t.stopTimer(t.ignoreUserInteractionTimerId)}),r)},e.prototype.initializeRefreshTokenLastMinuteInterval=function(){var e=this;this.autoRefreshTimerId||(this.autoRefreshTimerId=setTimeout((function(){var t;e.stopTimer(e.autoRefreshTimerId),e.autoRefreshTimerId=0,null===(t=e.autoRefreshParameters)||void 0===t||t.refreshTokenMethod()}),this.getMSTimeTillCallRefreshMethod()))},e.prototype.getMSTimeTillCallRefreshMethod=function(){return this.autoRefreshParameters?this.autoRefreshParameters.expire.getTime()-(new Date).getTime()-6e4:0},e.prototype.initializeDomEvent=function(e){window.removeEventListener(e,this.onUserInteraction),window.addEventListener(e,this.onUserInteraction)},e.prototype.addMinutes=function(e,t){return new Date(e.getTime()+6e4*t)},e.prototype.getIgnoreUserInteractionInterval=function(e){return this.addMinutes(e,-16).getTime()-(new Date).getTime()},e.prototype.stopTimer=function(e){e&&clearTimeout(e)},e}()),Ir=function(){function e(e){var t=this;void 0===e&&(e=null),this.initialized=!1,this.onPopupMessage=function(e){return d.replaceUrl(e),t.initialize()},this.signIn=function(e,r,n){void 0===e&&(e={}),void 0===n&&(n=qt.token),t.checkInitialized();var o=t,i=o.adobeIdData,a=o.csrfService.initialize();return i.createRedirectRequest(e,r,a,n).then((function(e){t.signInservice.signIn(e)}))},this.authorizeToken=function(e,r,n,o){void 0===e&&(e=""),void 0===r&&(r={}),void 0===o&&(o=qt.token);var i=t,a=i.adobeIdData,s=i.csrfService.initialize();return a.createRedirectRequest(r,n,s,o).then((function(t){(new Gt).authorizeToken(e,t)}))},this.reAuthenticate=function(e,r,n,o){void 0===e&&(e={}),void 0===r&&(r=Mt.check),void 0===o&&(o=qt.token),t.checkInitialized();var i=t,a=i.adobeIdData,s=i.csrfService.initialize();return a.createReAuthenticateRedirectRequest(e,n,s,r,o).then((function(e){t.signInservice.signIn(e)}))},this.signInWithSocialProvider=function(e,r,n,o){if(void 0===r&&(r={}),void 0===o&&(o=qt.token),t.checkInitialized(),!e)throw new Error("please provide the provider name");var i=t,a=i.adobeIdData,s=i.csrfService.initialize();a.createSocialProviderRedirectRequest(e,r,n,s,o).then((function(e){t.signInservice.signIn(e)}))},this.signOut=function(e){void 0===e&&(e={}),t.checkInitialized(),t.tokenService.purge(),t.profileService.removeProfile();var r=t.adobeIdData,n=r.api_parameters,o=void 0===n?{}:n,i=r.client_id,a={adobeIdRedirectUri:r.redirect_uri,apiParameters:o,clientId:i,externalParameters:e};(new Xt).signOut(a)},this.refreshToken=function(e){return void 0===e&&(e={}),t.tokenService.refreshToken(e).then((function(e){return t.onTokenProfileReceived(e)})).catch((function(e){return l.error("refresh token error",e),e instanceof ir?Promise.reject(e):e instanceof or?e.jump?(d.replaceUrl(e.jump),Promise.reject(e)):Promise.reject(e):(t.profileService.removeProfile(),t.onTokenExpired(),Promise.reject(e))}))},this.switchProfile=function(e,r){return void 0===r&&(r={}),e?t.tokenService.switchProfile(e,r).then((function(e){return t.onTokenProfileReceived(e)})).catch((function(e){return e instanceof ir?Promise.reject(e):e instanceof or&&e.jump?(d.replaceUrl(e.jump),Promise.reject(e)):Promise.reject(e)})):Promise.reject(new Error("Please provide the user id for switchProfile"))},this.triggerOnImsInstance=function(e){var r=document.createEvent("CustomEvent"),n={clientId:t.adobeIdData.client_id,instance:e};r.initCustomEvent("onImsLibInstance",!1,!1,n),window.dispatchEvent(r)},this.processInitializeException=function(e){void 0===e&&(e={});var r=t.adobeIdData.handlers;return l.warn("initialize",e),e instanceof br?t.notifyParentAboutModalSignIn(e):(t.restoreHash(),e instanceof yr&&r.triggerOnAccessTokenHasExpired(),Promise.reject(e))},this.verifyRideErrorException=function(e){return e instanceof or&&e.jump&&d.replaceUrl(e.jump),Promise.reject(e)},this.verifyCsrfException=function(e){var r=e.type;return r&&r===Yt.CSRF&&t.signOut(),Promise.reject(e)},this.processTokenResponse=function(e){var r=t.adobeIdData.handlers,n=e.tokenFields,o=e.profile,i=n.tokenValue,a=n.state,s=n.expire,c=n.sid,u=n.user_id,p=n.other,f=void 0===p?{}:p;l.info("token",i),f.from_ims&&d.setHash(f.old_hash||""),t.profileService.removeProfileIfOtherUser(u);var h={token:i,expire:s,sid:c};return n.isReauth()?r.triggerOnReauthAccessToken(h):t.tokenReceived(h),o&&t.profileService.saveProfileToStorage(o),Promise.resolve(a)},this.exchangeIjt=function(e){var r=t.adobeIdData.ijt;return e||r?t.tokenService.exchangeIjt(e||r).then((function(e){return t.profileService.removeProfile(),Promise.resolve(e)})):Promise.reject(new Error("please set the adobeid.ijt value"))},this.adobeIdData=new rr(e);var n=this.adobeIdData,o=n.api_parameters,i=void 0===o?{}:o,a=n.client_id,s=n.scope,c=n.useLocalStorage,u=n.autoValidateToken,p=n.modalMode,h=n.modalSettings;this.imsApis=new lr(i),this.csrfService=new f(a),this.serviceRequest={clientId:a,scope:s,imsApis:this.imsApis},this.tokenService=new wr(r(r({},this.serviceRequest),{useLocalStorage:c,autoValidateToken:u}),this.csrfService),this.profileService=new dr(this.serviceRequest),this.signInservice=p?new $t(this.onPopupMessage,h):new Gt}return Object.defineProperty(e.prototype,"version",{get:function(){return h.jslibver},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adobeid",{get:function(){return r({},this.adobeIdData)},enumerable:!0,configurable:!0}),e.prototype.enableLogging=function(){l.enableLogging()},e.prototype.disableLogging=function(){l.disableLogging()},e.prototype.checkInitialized=function(){this.initialized},e.prototype.signUp=function(e,t){var r=this;void 0===e&&(e={}),this.checkInitialized();var n=this.adobeIdData,o=this.csrfService;if(!n)throw new Error("no adobeId on reAuthenticate");var i=o.initialize();return n.createSignUpRedirectRequest(e,t,i).then((function(e){r.signInservice.signIn(e)}))},e.prototype.isSignedInUser=function(){return!!this.getAccessToken()},e.prototype.getProfile=function(){var e=this,t=this.profileService.getProfileFromStorage();if(t)return Promise.resolve(t);var r=this.getAccessToken();if(!r){return Promise.reject(new fr("please login before getting the profile"))}return this.profileService.getProfile(r.token).then((function(e){return Promise.resolve(e)})).catch((function(t){return l.error("get profile exception ",t),t instanceof ir?e.refreshToken().then((function(e){return Promise.resolve(e.profile)})):Promise.reject(new fr(t.message||t))}))},e.prototype.avatarUrl=function(e){return this.imsApis.avatarUrl(e)},e.prototype.getReleaseFlags=function(){return this.tokenService.getReleaseFlags()},e.prototype.getAccessToken=function(){var e=this.tokenService.getTokenFieldsFromStorage();return e?{token:e.tokenValue,expire:e.expire,sid:e.sid}:null},e.prototype.getReauthAccessToken=function(){var e=this.tokenService.getTokenFieldsFromStorage(!0);return e?{token:e.tokenValue,expire:e.expire,sid:e.sid}:null},e.prototype.listSocialProviders=function(){var e=this;return new Promise((function(t,r){var n=e.adobeIdData.client_id;e.imsApis.listSocialProviders({client_id:n}).then((function(e){t(e)})).catch((function(e){r(e)}))}))},e.prototype.tokenReceived=function(e){this.adobeIdData.handlers.triggerOnAccessToken(e),Sr.startAutoRefreshFlow({expire:e.expire,refreshTokenMethod:this.refreshToken})},e.prototype.onTokenProfileReceived=function(e){var t=e.tokenInfo,r=e.profile;return l.info("token",t),this.tokenReceived(t),this.profileService.saveProfileToStorage(r),Promise.resolve(e)},e.prototype.validateToken=function(){var e=this;return this.tokenService.validateToken().then((function(){return Promise.resolve(!0)})).catch((function(t){return l.warn("validate token exception",t),t instanceof ir?Promise.reject(!1):(e.profileService.removeProfile(),Promise.reject(!1))}))},e.prototype.onTokenExpired=function(){var e=this.adobeIdData.handlers;this.tokenService.purge(),e.triggerOnAccessTokenHasExpired()},e.prototype.setStandAloneToken=function(e){return this.tokenService.setStandAloneToken(e)},e.prototype.initialize=function(){var e=this,t=this.adobeIdData,r=t.handlers,n=t.standalone,o=t.ijt,i=null;return n&&this.setStandAloneToken(n),(o?this.exchangeIjt:this.tokenService.getTokenAndProfile)().then(this.processTokenResponse,(function(t){return e.processInitializeException(t).catch((function(t){return e.verifyRideErrorException(t)})).catch((function(t){return e.verifyCsrfException(t).catch((function(e){return l.info("initialize exception ended",e)}))}))})).then((function(e){i=e})).finally((function(){return l.info("onReady initialization"),window.addEventListener("getImsLibInstance",(function(){e.triggerOnImsInstance(e)}),!1),r.triggerOnReady(i?i.context:null),e.triggerOnImsInstance(e),e.initialized=!0,Promise.resolve(i)}))},e.prototype.notifyParentAboutModalSignIn=function(e){var t=window.location.href.replace("imslibmodal","wasmodal");return window.opener?(window.opener.postMessage(t,"*"),window.close()):window[""+e.wndRedirectPropName]=t,Promise.reject("popup")},e.prototype.restoreHash=function(){var e=vr.fragmentToObject();e&&e.from_ims&&d.setHash(e.old_hash||"")},e.prototype.getTransitoryAuthorizationCode=function(e,t){return void 0===t&&(t={}),(e=e||{}).response_type=e.response_type||"code",e.target_client_id=e.target_client_id||this.adobeIdData.client_id,e.target_scope=e.target_scope||this.adobeIdData.scope,this.imsApis.getTransitoryAuthorizationCode(e,t,this.adobeIdData.client_id)},e.prototype.jumpToken=function(e,t){return void 0===t&&(t={}),e.target_client_id=e.target_client_id||this.adobeIdData.client_id,e.target_scope=e.target_scope||this.adobeIdData.scope,this.imsApis.jumpToken(e,t,this.adobeIdData.client_id)},e}(),Rr=new(function(){function e(){this.createIMSLib=function(e,t){void 0===e&&(e=null),void 0===t&&(t="adobeIMS");var r=new Ir(e);return window[t]=r,r}}return e.prototype.initAdobeIms=function(){window.adobeImsFactory={createIMSLib:this.createIMSLib};var e=window.adobeIMS||null;if(!e){var t=window.adobeid;if(!t)return;(e=this.createIMSLib(t,"adobeIMS")).initialize()}},e}());return new(function(){function e(){Rr.initAdobeIms()}return e.prototype.initialize=function(){return!0},e}())}();
