!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@ali/wpk-reporter")):"function"==typeof define&&define.amd?define(["exports","@ali/wpk-reporter"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).iLogger={},e.wpkReporter)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=n(t);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,i,r=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){l=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return r}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=d(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}var f=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e?null:{},o=document.cookie?document.cookie.split("; "):[],i=/(%[0-9A-Z]{2})+/g,r=0;r<o.length;r++){var a=o[r].split("="),l=a.slice(1).join("=");t.json||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=a[0].replace(i,decodeURIComponent);if(l=l.replace(i,decodeURIComponent),t.json)try{l=JSON.parse(l)}catch(e){}if(e===c){n=l;break}e||(n[c]=l)}catch(e){}}return n},p={ID:{id:"360",lang:["id","en"],langShort:["id","en"],currency:"IDR",domain:"lazada.co.id",regionID:"ID"},MY:{id:"458",currency:"MYR",lang:["en-MY","ms","zh"],langShort:["en","ms","zh"],domain:"lazada.com.my",regionID:"MY"},PH:{id:"608",currency:"PHP",lang:["en-PH"],langShort:["en"],domain:"lazada.com.ph",regionID:"PH"},SG:{id:"702",currency:"SGD",lang:["en-SG","zh"],langShort:["en","zh"],domain:"lazada.sg",regionID:"SG"},TH:{id:"764",currency:"THB",lang:["th","en"],domain:"lazada.co.th",regionID:"TH"},VN:{id:"704",currency:"VND",lang:["vi","en"],domain:"lazada.vn",regionID:"VN"}},w=navigator.userAgent||"";function g(e){return e?e.split("|"):[]}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e=e.toLocaleUpperCase();var n=p[e]?p[e].lang:[];if(!Array.isArray(n))return t;for(var o="",i=0;i<n.length;i++){var r=n[i];if(r&&r.indexOf(t)>-1){o=r;break}}return o||(o=n[0]),o}function m(){var e={},t={};if("undefined"==typeof window||"undefined"==typeof performance||"undefined"==typeof MutationObserver)void 0!==e&&(e.exports={on:function(){},un:function(){}});else{var n=function(){x.observe(document.body,S),E=[],p(document.querySelectorAll("[ignoreFspCollection]"),(function(e){E.push(e)})),c(document.querySelectorAll("BODY > *")),setTimeout((function(){o(!0)}),h)},o=function(e){_||(O=!0,b&&clearTimeout(b),x.disconnect(),x.takeRecords(),E=[],setTimeout((function(){_=!0,s(e)}),1e3))},i=function(e){return e.width&&e.height&&e.top<screen.height&&e.left<screen.width&&e.top+e.height>0&&e.left+e.width>0},r=function(e,t,n){var o=n||0;return p(e,(function(e){o=t(e,o)})),o},a=function(e){var t=function(){e.lastTime=Math.max(f(),e.lastTime),u()};window.requestAnimationFrame?requestAnimationFrame(t):setTimeout(t,0)},l=function e(t,n,o){var l=t.piece,c=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop||0,s=document.documentElement.scrollLeft||window.pageXOffset||document.body.scrollLeft||0,w=o?null:n.getBoundingClientRect(),h=o||{type:0,className:d(n),top:w.top+c,left:w.left+s,width:w.width,height:w.height},m=n.offsetParent;m&&m.offsetWidth<m.scrollWidth&&(h.width=Math.min(m.offsetWidth,h.width)),m&&m.offsetHeight<m.scrollHeight&&(h.height=Math.min(m.offsetHeight,h.height));var v=!0,y=n.tagName;if(-1!==T.indexOf(y.toUpperCase())&&(v=!1,"IMG"===y)){var b=0;if(h.width=Math.max(h.width,1),h.height=Math.max(h.height,1),h.type=1,i(h)){t.wait+=1,n.addEventListener("load",(function e(){if(_)n.removeEventListener("load",e,!0);else{b++,t.wait-=1;var o=n.getBoundingClientRect(),l=f();i(h)&&(b<=1||l<=1e3)?(h.width=o.width,h.height=o.height,t.lastTime=Math.max(l,t.lastTime),h.size=o.width*o.height,h.v=h.size/g,t.v=r(t.piece,(function(e,t){return e.v+t}),0),a(t)):u()}}),!0),n.addEventListener("error",(function e(){_?n.removeEventListener("error",e,!0):(t.wait-=1,i(h)?(t.lastTime=Math.max(f(),t.lastTime),0===t.wait&&(t.v=r(t.piece,(function(e,t){return e.v+t}),0),a(t))):u())}),!0)}}var O={};if(window.getComputedStyle&&("none"===(O=window.getComputedStyle(n,null)).display||"fixed"===O.position))return v=!1,l;if(i(h)){var E=O.backgroundImage||"",x=/url\(['"]?(.*?)['"]?\)/i;if(x.test(E)&&(E=E.replace(x,"$1"),!/^data:/i.test(E))){t.wait+=1;var S=document.createElement("img");S.onload=function(){t.wait-=1,t.lastTime=Math.max(f(),t.lastTime),0===t.wait&&a(t)},S.src=E}if(function(e,t){var n=null;for(var o in e)if(n=e[o],t.top>=n.top&&t.left>=n.left&&t.top+t.height<=n.top+n.height&&t.left+t.width<=n.left+n.width)return!0;return!1}(l,h)||(h.size=h.width*h.height,h.v=h.size/g,t.v+=h.v,h.size?l.push(h):v=!1),v){var I=n.children;p(I,(function(n){e(t,n)}))}}return l},c=function(e){var t=f(),n={createTime:t,lastTime:t,wait:0,piece:[],v:0,c:document.getElementsByTagName("*").length};p(e,(function(e){(function(e){for(var t=E.length,n=null,o=0;o<t;o++)if((n=E[o])&&n.contains&&n.contains(e))return!0;return!!e.hasAttribute("ignoreFspCollection")&&(E.push(e),!0)})(e)||l(n,e)})),n.piece.length>0&&(w.push(n),a(n))},d=function(){if(!y)return""},u=function(){if(!O&&!_){b&&clearTimeout(b),b=setTimeout((function(){y&&console.log("stop By Idle"),o()}),m);for(var e=null,t=null,n=0,i=0,r=0,a=0,l=0,c=w.length-1;c>1;c--){if(e=w[c],t=w[c-1],a=Math.floor(100*e.v)/100,i=(l=Math.floor(100*t.v)/100)?Math.abs(a-l)/l:0,(r+=e.v)>2){y&&console.log("stop By sum area 2",r),o();break}if(i<.5){if(++n>6){y&&console.log("stop By stable tail"),o();break}}else n>0&&(n=0)}}},s=function(){var e=w.length;if(0!==e){var n=[],i=[],r=[],a=-1,l=0,c=0,d=null,u=null,s=0,f=0;for(e=w.length-1;e>1;e--)if(d=w[e],u=w[e-1],s=Math.floor(100*d.v)/100,f=Math.floor(100*u.v)/100,(l=f?Math.abs(s-f)/f:0)>.1){if(++c>2)break}else c=0;for(i=c>2?w.slice(0,e+2):w;i.length>0;)if(a=i[0].lastTime,r=[],l=0,c=0,p(i,(function(e){l+=e.v,c++,e.createTime<=a+v&&(a=Math.max(a,e.lastTime)),e.lastTime>a&&r.push(e)})),i=r,l<.02||l/c<.01?(y&&console.log("ignore min render"),I++):I=0,n.push(a),I>=3){y&&console.log("stop By keep min render 3"),n.splice(n.length-3),o();break}var g=n.length-1;0!==I&&(g=Math.max(g-I,0));var h=g===n.length?-3:g-1;h<=0&&(h=0),t._fn(n[g],n.slice(h,h+3))}},f=function(){return performance.now()},p=function(e,t){if(Array.prototype.forEach)Array.prototype.forEach.call(e,t);else for(var n=e.length,o=0;o<n;o++)t(e[o],o)},w=window._t2Frames=[],g=screen.width*screen.height,h=3e4,m=3e3,v=200,y=0,b=null,_=!1,O=!1,T=["SCRIPT","LINK","SVG","IMG","VIDEO"],E=[],x=new MutationObserver((function(e){var t=[],n=[];p(e,(function(e){p(e.addedNodes,(function(e){1!==e.nodeType&&9!==e.nodeType||t.push(e)}))})),t.length+n.length>0&&c(t.concat(n))})),S={childList:!0,subtree:!0};document.body?n():document.addEventListener&&document.addEventListener("DOMContentLoaded",n);var I=0;t.on=function(e){t._fn=e},t.un=function(){t._fn=function(){}},t.un(),void 0!==e&&(e.exports=t)}return e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function v(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var y={exports:{}};!function(e,t){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==a(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3,MAINDOC:1e5,RESTIMING:100001},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},,,function(e,t,n){var o=n(0).env,i=function(e){var t;return(e&&(t=e.replace(/^#\/?/,""))&&"string"==typeof t?t.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):"")||"[index]"},r=function(e,t){if(t=t||{},e.env===o.BROWSER&&window)if(e.toolKit.extend({enable:!0},t).enable){e.logger.info("wpkflowPlugin已开启");var r,a,l=function(){e.reportFlow()};"complete"===document.readyState?setTimeout(l,0):e.toolKit.onListen(window,"load",l,!0),e.spa&&(n(4)(),r=function(t){i(location.hash)&&(e._begin=Date.now(),e._sid=e.toolKit.uuid(),e.reportFlow())},a=function(t){i(t.detail)&&(e._begin=Date.now(),e._sid=e.toolKit.uuid(),e.reportFlow())},e.toolKit.onListen(window,"hashchange",r),e.toolKit.onListen(window,"historystatechange",a)),e.toolKit.onListen(window,"beforeunload",(function(){e.toolKit.offListen(window,"load"),e.toolKit.offListen(window,"hashchange"),e.toolKit.offListen(window,"historystatechange"),l=r=a=null}))}else e.logger.info("wpkflowPlugin已关闭")};r.prototype.pluginId="flow",e.exports=r},function(e,t){var n=window.history||{},o=window.document,i=function(e,t){var n;window.CustomEvent?n=new CustomEvent(e,{detail:t}):((n=o.createEvent("HTMLEvents")).initEvent(e,!1,!0),n.detail=t),window.dispatchEvent(n)},r=function(e){return e&&"string"==typeof e?e.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):""},a=function(e){var t=n[e];"function"==typeof t&&(n[e]=function(e,o,a){var l=location.href,c=t.call(n,e,o,a);if(!a||"string"!=typeof a)return c;if(a===l)return c;try{var d=l.split("#"),u=a.split("#"),s=r(d[0]),f=r(u[0]),p=d[1]&&d[1].replace(/^\/?(.*)/,"$1"),w=u[1]&&u[1].replace(/^\/?(.*)/,"$1");s!==f?i("historystatechange",f):p!==w&&i("historystatechange",w)}catch(e){}return c},n[e].toString=e+"() { [native code] }")};e.exports=function(){a("pushState"),a("replateState")}}])}(y);var b=v(y.exports),_={exports:{}};!function(e,t){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==a(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}({0:function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3,MAINDOC:1e5,RESTIMING:100001},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},6:function(e,t,n){var o=n(0),i=o.sdk,r=o.http.methods,a=o.category,l=function(e){return e>=200&&e<=299},c=function(e){return-1===e.indexOf("//arms-retcode")&&-1===e.indexOf("//retcode.taobao.com")&&-1===e.indexOf("aliyuncs.com/r.png")&&-1===e.indexOf("//mdap.alipay.com/loggw")&&-1===e.indexOf("//wpk-gateway")&&-1===e.indexOf("//px.ucweb.com")&&-1===e.indexOf("//px.effirst.com")&&-1===e.indexOf("//px-intl.ucweb.com")&&-1===e.indexOf("//gm.mmstat.com/arms.1.1")&&-1===e.indexOf("//gm.mmstat.com/arms.1.2")&&-1===e.indexOf("//g.alicdn.com/alilog")},d=function(e,t){if(e.hasOwnProperty(t))return e[t]},u=function(e,t,n){e.toolKit.isObject(n)&&e.toolKit.extend(t,{c1:d(n,"c1"),c2:d(n,"c2"),c3:d(n,"c3"),c4:d(n,"c4"),c5:d(n,"c5"),bl1:d(n,"bl1"),bl2:d(n,"bl2"),bl3:d(n,"bl3"),bl4:d(n,"bl4"),bl5:d(n,"bl5")}),e.report(t)};function f(e){try{if(!e)return{};var t,n={},o=s(e);try{for(o.s();!(t=o.n()).done;){var i=t.value;n[i[0]]=i[1]}}catch(e){o.e(e)}finally{o.f()}return n}catch(e){return{}}}var p=function(e,t){if(e.env===o.env.BROWSER&&window){var n=e.toolKit.extend({enable:!0,sampleRate:1},t);n.enable?(e.logger.info("wpkinterfacePlugin已开启"),"fetch"in window&&function(e,t){var n=window.fetch;window.fetch=function(){var o=[].slice.call(arguments),d=r.GET;o[1]&&o[1].method&&(d=o[1].method.toUpperCase());var s=Date.now();return n.apply(this,o).then((function(n){try{var p=Date.now(),w=(n.url||o[0]).split("?"),g=w[0],h=w[1]||"",m="",v=null;o[1]&&(v=o[1].headers),d!==r.GET&&o[1]&&o[1].body&&(m=JSON.stringify(o[1].body));var y=n.clone(),b=f(y.headers);y.text().then((function(o){o=o||"";var i=!0,r={};if("function"==typeof t.errorFilter&&(i=!!(r=t.errorFilter.call(this,{url:g,status:n.status,response:o,body:m,queryString:h,reqHeaders:v,resHeaders:b})),e.logger.warn("api errorFilter执行结果：",r)),o=o.length>2048?"[response content too large]":o,i&&p-s<121e3&&c(g)){var f=r.bizCode||n.status,w={category:a.API,sampleRate:t.sampleRate,w_res:g,w_param:h,w_body:l(f)||!t.withBody?"":m,w_method:d,w_rc:f,w_rt:p-s,w_resp:l(f)||!t.withResp?"":r.resp||o,msg:r.msg||"",w_type:16};u(e,w,r)}}))}catch(t){e.reportError(t,{bid:i.BID,cid:i.CID,category:a.JSERR,sampleRate:1})}return n})).catch((function(e){throw e}))}}(e,n),(e.enableMtop||n.enableMtop)&&(e.logger.info("use mtop"),function(e,t){window&&window.lib.mtop&&window.lib.mtop.middlewares&&window.lib.mtop.middlewares.push((function(n){var o=this.params,r=this.options,d=Date.now();return n().then((function(){try{if(r.H5Request&&(r.getJSON||r.postJSON))return void e.logger.debug("识别到请求为xhr, api监控交由xhr的方式处理");var n,s=r.retJson||{},f=Date.now()-d,p=s.code||200,w=o.type,g=r.path||r.api,h=e.toolKit.objToQueryString(r.querystring),m=r.postdata&&r.postdata.data?e.toolKit.objToJsonString(r.postdata.data):null,v=e.toolKit.objToJsonString(s.data||{}),y=s.ret;y instanceof Array&&(y=y.join(",")),-1===y.indexOf("SUCCESS")&&(n=y);var b=!0,_={};if("function"==typeof t.errorFilter&&(b=!!(_=t.errorFilter.call(this,{url:g,status:p,response:v,body:m,queryString:h,msg:n})),e.logger.warn("api errorFilter执行结果：",_)),b&&f<121e3&&c(g)){var O=_.bizCode||p,T={category:a.API,sampleRate:t.sampleRate,w_res:g,w_param:h,w_body:l(O)||!t.withBody?"":m,w_method:w,w_rc:O,w_rt:f,w_resp:l(O)||!t.withResp?"":_.resp||v,msg:_.msg||n||"",w_type:16};u(e,T,_)}}catch(t){e.reportError(t,{bid:i.BID,cid:i.CID,category:a.JSERR,sampleRate:1})}}))}))}(e,n))):e.logger.info("wpkinterfacePlugin已关闭")}};p.prototype.pluginId="api",e.exports=p}})}(_);var O=v(_.exports),T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.__wpk&&window.__wpk.report&&(window.__wpk.report({category:201,msg:"蹦失率",w_succ:e,c1:"when=".concat(t.when||"")}),console.log("[aplus_exp_hook] report exp break",e))},E=function(){window.addEventListener("unload",(function(e){window.__lzd_fsp_done||T(1,{when:"unload"})}),{capture:!0}),document.addEventListener("visibilitychange",(function(){document.hidden&&(window.__lzd_fsp_done||window.__lzd_hidden_reported||(T(1,{when:"hidden"}),window.__lzd_hidden_reported=!0))}))},x=[/c\.go\-mpulse\.net/,/ds\-aksb\-a\.akamaihd\.net\/RRT/,/s\.akamaihd\.net\/eum\/getdns\.txt/,/pre\-wormhole/],S=["SUCCESS","UNION_NOT_MATCH_FREQUENCY"];var I=/AliApp/.test(w),P=f("lzd_uid"),k=(navigator.userAgent||"").toLowerCase().indexOf("android")>-1,j="1.0.41",D=!!document.querySelector("meta[name='wpk-bid']"),R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e;if(e.includes("?")){var o=e.split("?"),i=c(o,2),r=i[1];n=void 0===r?"":r}if(n.includes("#")){var a=n.split("#"),l=c(a,1),d=l[0];n=void 0===d?"":d}for(var u=n.split("&"),s={};u.length;){var f=u.shift(),p=f.split("="),w=c(p,2),g=w[0],h=void 0===g?"":g,m=w[1],v=void 0===m?"":m;h&&(s[h]=t?decodeURIComponent(v):v)}return s}(),L={},M=!1,A=!1,N="";if(D){var C=document.head.querySelector('meta[name="wpk-bid"]');C&&C.getAttribute("content")&&(N=C.getAttribute("content"))}!D&&k&&console.warn("It is strongly recommended that integrate iTrace UC core monitor to your page, https://yuque.antfin-inc.com/wpk/help/vfx057");var z,H=!(!(z="object"===("undefined"==typeof location?"undefined":a(location))&&location.hostname||"")||!(z.indexOf("i.lazada.")>=0||z.indexOf("-p.lazada.")>=0||z.indexOf("pre-wormhole.")>=0||z.indexOf("-staging.lazada.")>=0)||!R.iTraceDebug),F={en:"Network error, please try again later",id:"Kesalahan jaringan, coba lagi nanti",ms:"Ralat rangkaian, sila cuba lagi kemudian",my:"ကွန်ယက်ကိုအမှား, နောက်မှာထပ်ကြိုးစားကြည့်ပါ",th:"ข้อผิดพลาดของเครือข่ายโปรดลองอีกครั้งในภายหลัง",vi:"Lỗi mạng, vui lòng thử lại sau",bn:"নেটওয়ার্ক ত্রুটি, দয়া করে পরে আবার চেষ্টা করুন",si:"ජාල දෝෂය, නැවත උත්සාහ කරන්න",ne:"सञ्जाल त्रुटि, कृपया पछि फेरि प्रयास गर्नुहोस्",ur:"نیٹ ورک کی غلطی، براہ کرم بعد میں دوبارہ کوشش کریں"};function G(){var e=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t="",n="",o=g(f("hng"));if("object"===("undefined"==typeof window?"undefined":a(window))&&window._i18n_){var i=window._i18n_;if("string"==typeof i)try{i=JSON.parse(i)}catch(e){}"object"===a(i)&&(t=i.regionID,n=i.language)}if(!t&&window.g_config&&"object"===a(window.g_config)&&(t=window.g_config.regionID,n=window.g_config.language),!t&&"object"===("undefined"==typeof location?"undefined":a(location))&&location.hostname){for(var r in p){var l=p[r];if(l&&l.domain&&location.hostname.indexOf(l.domain)>-1){t=l.regionID;break}}o.length>1&&(n=o[1])}return t||o.length>=4&&(t=o[0],n=o[1]),n=h(t=t||"SG",n)||"en",e&&(n=n.substring(0,2)),{regionID:t.toLocaleUpperCase(),language:n}}(),t=e.language;return F[(void 0===t?"EN":t).toLowerCase()]||F.en}var K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.pid){var t=null;return window.__wpk?(e.pid&&(e.bid=e.pid,delete e.pid),window.__wpk.setConfig(e),t=window.__wpk):(D&&I&&k?(t=new o.default({bid:e.pid,cid:e.cid||"",uid:e.uid||P,rel:e.rel||j,cluster:"intl",plugins:[[b,{enable:!1}]],debug:e.isDebug||H})).install():(t=new o.default({bid:e.pid,cid:e.cid||"",uid:e.uid||P,rel:e.rel||j,cluster:"intl",plugins:[[O,{enable:!1}]],debug:e.isDebug||H})).installAll(),window.__wpk=t),console.log("lzd-h5-itrace version: v".concat(j)),t}console.warn("[lzd-h5-itrace] 实例化失败，缺少必要参数")},U=function(e,t,n,o,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l=window.__wpk;window.__wpk?x.some((function(t){return t.test(e)}))||l.reportApiError(r({msg:i,url:e,method:t,status:o,spent:n,response:o},a),{}):console.warn("[lzd-h5-itrace] 请先调用 iLoggerIntegrate 方法进行初始化，再调用这个方法")},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};A||(A=!0,window.__wpk||K(e),m&&m().on((function(t){if(window.__lzd_fsp_done=!0,window.__wpk&&window.__wpk.report){var n=Math.floor(t)-Math.floor(window.preLoadTime||0);if(n>0&&n<2e4)window.__wpk.report({category:e.category||200,msg:e.msg||"自定义首屏",wl_avgv1:n,c1:n,c2:t,c3:window.preLoadTime||"-"});else{var o=n<0?"负值":"极大值 (>20s)";window.__wpk.report({category:e.category||200,msg:"".concat(o),c1:n,c2:t,c3:window.preLoadTime||"-"})}}})))},W=function(e){var t;M||(window.__wpk||K(e),window,(t=window.lib||(window.lib={}))&&t.mtop&&!t.mtop.ERROR?(t.mtop.middlewares.push((function(e){var t=this.params,n=this.options,o=n.querystring,i=parseInt((void 0===o?{}:o).t)||Date.now();return e().then((function(){var e,o="",r="",a="",l=n.retJson,c=void 0===l?{}:l,d=n.path,u=c.api,f=c.responseHeaders,p=void 0===f?"":f,w=c.ret,g=function(e){var t,n=s(e.split("\r\n"));try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.indexOf("x-eagleeye-id")>-1){var i=o.split(":");return i[1]?i[1]:""}}}catch(e){n.e(e)}finally{n.f()}return""}(p),h=function(e){var t=e&&e.length&&e[0].split("::");return-1!==e[0].indexOf("FAIL_SYS")||-1!==e[0].indexOf("SYSTEM_ERROR")||-1!==e[0].indexOf("UNKNOWN_FAIL_CODE")||-1!==e[0].indexOf("TIMEOUT")?{key:t[0],displayMessage:G()}:t&&t[1]?{key:t[0],displayMessage:t[1]}:{key:e[0],displayMessage:G()}}(w),m=h.displayMessage,v=t.type||"";if(e=t.ext_headers&&t.ext_headers["x-uid"]||"",I){var y=n.subDomain,b=n.pageDomain,_=(n.results[0]||{}).stat,O=void 0===_?{}:_;r=S.includes(h.key)?200:0,o=O.oneWayTime||Date.now()-i,a=u?"https://".concat(y,".").concat(b,"/gw/").concat(u):"https:".concat(d)}else r=S.includes(h.key)?200:0,o=Date.now()-i,a="https:".concat(d);U(a,v,o,r,h.key,{c1:e,c2:g,c3:m})}))})),M=!0,console.log("[lzd-h5-itrace] mtop itrace plugin init success!")):console.warn("[lzd-h5-itrace] Mtop 没有初始化，无法添加 Mtop Itrace 监控插件！请参考 Mtop 文档 http://gitlab.alibaba-inc.com/mtb/lib-mtop ",t))};!function(){if(window){window.addEventListener("oniLoggerMtopPluginInit",(function(e){W(e.detail)}),!1);var e=!0;if(window.lib?window.lib.mtop&&(e=!1):window.lib={},e&&Object.defineProperty(window.lib,"mtop",{get:function(){return window.__lzdlib_mtop__},set:function(e){window.__lzdlib_mtop__=e,Object.defineProperty(window.lib.mtop,"middlewares",{get:function(){return window.__lzdlib_mtop_middlewares__},set:function(e){var t=new CustomEvent("oniLoggerMtopPluginInit",{detail:L||{}});window.__lzdlib_mtop_middlewares__=e,window.dispatchEvent(t)},configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0}),N){var t={selfDefineFSP:!0,mtopPluginInit:!0,aplusExpHook:!0},n=document.head.querySelector('meta[name="lzd-itrace-close-auto-monitor"]');if(n&&n.getAttribute("content"))n.getAttribute("content").split(",").forEach((function(e){var n=e.trim();t[n]=!1}));K({pid:N}),t.selfDefineFSP?B({pid:N}):console.log("[lzd-h5-itrace] close auto run selDefineFSP"),window.lib&&window.lib.mtop&&t.mtopPluginInit?W({pid:N}):console.log("[lzd-h5-itrace] close auto run mtopPluginInit"),t.aplusExpHook?E():console.log("[lzd-h5-itrace] disable aplus_exp_hook")}}}(),e.iLoggerInit=K,e.iLoggerIntegrate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";try{t=K(e)}catch(e){console.log("[lzd-h5-itrace] catch iTrace sdk error, make program go on!")}return B(e),L=e,W(e),E(),t},e.iLoggerMtopPluginInit=W,e.iLoggerReportApi=U,e.iLoggerSelfDefineFSP=B,Object.defineProperty(e,"__esModule",{value:!0})}));
