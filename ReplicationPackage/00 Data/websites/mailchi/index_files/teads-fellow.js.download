"use strict";!function(){const e={conversionType:"conversion_type"},t="none",n="chrome_90_api",o="chrome_92_api";function i(e){return{[n]:"".concat("https://cm.teads.tv","/conversion"),[o]:"".concat("https://cm.teads.tv","/v2/conversion")}[e]||null}function a(e){let t="";const n=function(e){let t=e,n=!1;try{for(let e=0;t.parent.document!==t.document||e<50;e+=1){if(!t.parent.document){n=!0;break}t=t.parent}}catch(e){n=!0}return{topFrame:t,err:n}}(e),{topFrame:o}=n;if(n.err)try{t=o.top.location.href}catch(e){t=o.location.href}else t=o.location.href;return t}function c(e,t){try{const n={errorMessage:e,topUrl:a(window),userAgent:void 0!==window.navigator&&void 0!==window.navigator.userAgent?window.navigator.userAgent:"",exception:t||""};e=JSON.stringify(n)}catch(e){}document.createElement("img").src="".concat("https://l.teads.tv/performance/http-source","?").concat(encodeURIComponent(e))}function r(e){const t=document.createElement("img");t.width=0,t.height=0,t.alt="",t.style.position="absolute",t.src=e,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]||document.getElementsByTagName("script")[0].parentNode).insertBefore(t,null)}function d(e){try{const t=new RegExp(/(?:\?|&|%3F|%26)auctid(?:=|%3D)([0-9a-zA-Z-_]*)/).exec(e);if(t&&t.length>=2)return t[1]}catch(e){c("Error when extracting Auction ID from url",null==e?void 0:e.message)}return null}async function s(e,t,n){const o=p(),i=v(),r=await async function(){try{return g()&&((e=document.interestCohort)&&"function"==typeof e&&"[object Function]"===Object.prototype.toString.call(e))&&await document.interestCohort()||{}}catch(e){return c(" Unable to retrieve interest cohort data",null==e?void 0:e.message),{}}var e}(),s=function(e){const t=[];return Object.keys(e).forEach(n=>{t.push("".concat(n,"=").concat(encodeURIComponent(e[n])))}),t.join("&")}(t),u=a(window),m=function(e){let t=window.teads_auction_id;if(!t){let n=e;e||(n=a(window)),t=d(n),t&&l(t)}return t}(u),w=function(e){const t=["account","password","pass","secret","secretkey","username","user","login","ordernumber","orderid","email","mail","user.email","user.password","user.name","user.mail","user.lastname","user.firstname","user.phone","user.phonenumber","lastname","firstname","name","address","phonenumber","phone","client_secret","guid"];if(""!==e){const n=e.split("?").length>1?e.split("?")[1]:void 0;if(void 0!==n){let o="".concat(e.split("?")[0],"?");const i=n.split("&");for(let e=0;e<i.length;e+=1){const n=i[e].split(/=(.+)/);o="".concat(o+(0===e?"":"&")+n[0],"=").concat(t.indexOf(n[0])>=0?"XXXXXXXX":n[1])}e=o}}return e}(u);let f="".concat(n,"?action=").concat(e,"&env=js-web&tag_version=").concat(encodeURIComponent("2.0.3"));return s.length>0&&(f="".concat(f,"&").concat(s)),void 0!==i?f="".concat(f,"&buyer_pixel_id=").concat(encodeURIComponent(i)):void 0!==o&&(f="".concat(f,"&advertiser_id=").concat(encodeURIComponent(o))),r.id&&(f="".concat(f,"&cohort_id=").concat(encodeURIComponent(r.id))),r.version&&(f="".concat(f,"&cohort_version=").concat(encodeURIComponent(r.version))),f="".concat(f,"&referer=").concat(encodeURIComponent(w)),m&&(f="".concat(f,"&auctid=").concat(m,"&vid=").concat(m)),f}function u(t,n){const o={};return Object.keys(t).forEach(i=>{const a=i,r=t[i];Object.prototype.hasOwnProperty.call(e,a)?o[e[a]]=r+(n||""):c("Invalid parameter specified in event: ".concat(a))}),o}function l(e){window.teads_auction_id=e}async function m(){try{const{firstPartyCookieAllowed:e,auctionId:t,domain:n}=await async function(){const e=p(),t=v();if(void 0===t&&void 0===e)return{firstPartyCookieAllowed:!1};const n=a(window);let o="referer=".concat(encodeURIComponent(n));o+=void 0!==t?"&buyer_pixel_id=".concat(encodeURIComponent(t)):"&advertiser_id=".concat(encodeURIComponent(e));try{const e=await fetch("".concat("https://cm.teads.tv","/v2/advertiser?").concat(o));if(200===e.status){const t=await e.json();return{firstPartyCookieAllowed:!0===(null==t?void 0:t.first_party_cookie_allowed),auctionId:null==t?void 0:t.auction_id,domain:null==t?void 0:t.domain}}}catch(e){c("Error while trigger API to know if first-party cookie is allowed",null==e?void 0:e.message)}const i=d(n);return i?{firstPartyCookieAllowed:!1,auctionId:i}:{firstPartyCookieAllowed:!1}}();if(t&&l(t),e)if(t);else{(function(e){try{const t="".concat(e,"="),n=[];for(let e=0;e<n.length;e+=1)if(n[e]=n[e].trim(),0===n[e].indexOf(t))return n[e].substring(t.length,n[e].length)}catch(e){c("Error while reading first-party cookie",null==e?void 0:e.message)}})("tfpai")}}catch(e){c("Error while setup first-party cookie",null==e?void 0:e.message)}}async function w(){const e=p(),t=v();"number"!=typeof e&&"number"!=typeof t||(await m(),await async function(){r(await s("pageView",{},"https://t.teads.tv/track"));const e=i(h());if(e){r(await s("pageView",{},e))}if(!window.teads_disable_time_on_site_tracking){let e=!1;const t=await s("timeSpent",{},"https://t.teads.tv/track");document.addEventListener("visibilitychange",()=>{"hidden"!==document.visibilityState||e||(e=!0,function(e){navigator&&navigator.sendBeacon&&navigator.sendBeacon(e)||r(e)}(t))})}}())}async function f(){y(),function(){const e=document.createElement("meta");e.httpEquiv="origin-trial",e.content="A/j6QtZ5QtlZcLGHuYBce5i3WFMXVvc89MjxJazvAJx/Vk5s4X8XcCtbAFmv8NFM084EjqJGNfn99gg0FUhvIgYAAAB6eyJvcmlnaW4iOiJodHRwczovL3RlYWRzLnR2OjQ0MyIsImZlYXR1cmUiOiJJbnRlcmVzdENvaG9ydEFQSSIsImV4cGlyeSI6MTYyNjIyMDc5OSwiaXNTdWJkb21haW4iOnRydWUsImlzVGhpcmRQYXJ0eSI6dHJ1ZX0=",document.head.appendChild(e)}();try{window.teads_disable_time_on_site_tracking||Object.defineProperty(window,"teads_disable_time_on_site_tracking",{set(e){this._teads_disable_time_on_site_tracking=e},get(){return this._teads_disable_time_on_site_tracking},configurable:!0}),window.teads_adv_id||Object.defineProperty(window,"teads_adv_id",{set(e){this._teads_adv_id=e,w()},get(){return this._teads_adv_id},configurable:!0}),window.teads_buyer_pixel_id||Object.defineProperty(window,"teads_buyer_pixel_id",{set(e){this._teads_buyer_pixel_id=e,w()},get(){return this._teads_buyer_pixel_id},configurable:!0})}catch(e){c("Error while binding advertiser and pixel ids",null==e?void 0:e.message)}await w();const e=window.teads_e||[];window.teads_e=[],window.teads_e.push=function(...e){return Array.prototype.push.apply(this,e),async function(){if(void 0!==window.teads_e){const e=[];for(;window.teads_e.length;)e.push(_(window.teads_e.shift()));await Promise.all(e)}else c("The event queue is not defined.")}(),window.teads_e.length},window.teads_e.push(...e)}function p(){if(void 0!==window.teads&&void 0!==window.teads.advertiserId){if("number"==typeof window.teads.advertiserId)return window.teads.advertiserId;c("The format of AdvertiserId is not valid.")}else{if(void 0===window.teads_cv||void 0===window.teads_cv.advertiserId)return window.teads_adv_id;if("number"==typeof window.teads_cv.advertiserId)return window.teads_cv.advertiserId;c("The format of AdvertiserId is not valid.")}}function v(){return window.teads_buyer_pixel_id}async function _(e){r(await s("conversion",u(e),"https://t.teads.tv/track"));const t=i(h());if(t){r(await s("conversion",u(e),t))}}function h(){const e=!!document.featurePolicy&&!!document.featurePolicy.features();return g()&&e&&document.featurePolicy.features().includes("conversion-measurement")?n:g()&&e&&document.featurePolicy.features().includes("attribution-reporting")?o:t}function y(){const e=document.createElement("meta");e.httpEquiv="origin-trial",e.content="A/uHLcJgMHGzbaImNy0hJCKohGWqUMJE9LGFzNyfrtou5IuW9r77J73+OMKk9tWO6oh9V8TTUB11oCxAHG1tUA8AAAB+eyJvcmlnaW4iOiJodHRwczovL3RlYWRzLnR2OjQ0MyIsImZlYXR1cmUiOiJDb252ZXJzaW9uTWVhc3VyZW1lbnQiLCJleHBpcnkiOjE2MzQwODMxOTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9",document.head.appendChild(e)}function g(){return!!window.chrome}async function b(e){try{"undefined"!=typeof window&&(e>0&&void 0===window.teads_cv?setTimeout(f,e):await f())}catch(e){c("Unhandled exception",null==e?void 0:e.message)}}b(200),"undefined"!=typeof module&&void 0!==module.exports&&(module.exports.tag=b,module.exports.getTopUrl=a,module.exports.setConversionMeasurementTrialToken=y)}();