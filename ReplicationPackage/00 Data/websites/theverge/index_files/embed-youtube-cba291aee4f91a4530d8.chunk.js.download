/*! For license information please see embed-youtube-cba291aee4f91a4530d8.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{420:function(e,t,n){(function(e){function t(e){return t="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n,i;n=window,i={debug:!1,create:function(e,t){return function(e,t,n,i){function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var r=o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o(),a="@app",s=t||"xframe",u="@res",c=200,d=[],l={},h={},f=0,p=null,y=null;return{host:n||"*",get id(){return r},src:function(e){return"string"===typeof e&&(e=document.querySelector(e)),e&&e instanceof Element&&e.contentWindow&&(e=e.contentWindow),e&&"function"===typeof e.postMessage?e:null},post:function(t,n,i){if(!(t=this.src(t))||!n)return e.error("invalid post");var o="string"===typeof n?{message:n}:n;if(void 0!==i&&(o.value=i),o.message){o[a]=s;try{t.postMessage(JSON.stringify(o),this.host)}catch(r){e.error(r)}}},request:function(t,n,i,o,a){if(!(t=this.src(t))||!n)return e.error("invalid request");var s=this,u=r+"-"+("0000"+f++).slice(-4),d=l[u]={timeout:a||15e3,attempts:0,src:t,cb:o,data:{message:n,value:i,id:u}};function h(){var e=!1;for(var t in l)if(l.hasOwnProperty(t)){var n=l[t];n.attempts++<n.timeout/c?(s.post(n.src,n.data),e=!0):s.end(t,new Error("request timeout"))}p=e?setTimeout(h,c):null}return p?this.post(t,d.data):h(),u},end:function(e,t){var n=e.id||e,i=t&&t.abort;if(l.hasOwnProperty(n)){var o=l[n];delete l[n],i||"function"!==typeof o.cb||o.cb(t||null,e.value)}},on:function(e,t,n){return d.push({message:e,fn:t,ctx:n}),this},listen:function(){if(!y){var e=function(e,t){for(var n,i=0;i<d.length;i++){var o=d[i];o.message===t.message&&(n=o.fn.call(o.ctx,e,t.value))}return n},t=this;y=function(n){var i,o="*"===t.host||String(n.origin).indexOf(t.host)>=0;if(o&&/^\{.*\}$/.test(n.data))try{i=JSON.parse(n.data)}catch(c){i=null}if(o&&i&&i[a]===s)if(i.id){var r=i.message===u;r&&l.hasOwnProperty(i.id)?t.end(i):r||h.hasOwnProperty(i.id)||(h[i.id]=!0,t.post(n.source,{message:u,value:e(n,i)||"success",id:i.id}))}else e(n,i)},i.addEventListener("message",y)}return this},stopListening:function(){return y&&(i.removeEventListener("message",y),y=null),this},dispose:function(){clearInterval(p),this.stopListening()}}}(this,e,t,n)},isInIframe:function(){try{return n.parent&&n.self!==n.top}catch(e){return!0}},error:function(e){if(this.debug)throw e}},"object"===t(e)&&e.exports?e.exports=i:n.IframeClient=i}).call(this,n(136)(e))},556:function(e,t,n){"use strict";n.r(t);var i=n(461),o=n(20),r=n(64);var a=function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.allowPersonalizedCookies()){var i=t&&t.asset&&t.asset.chartbeat_account_id;if(!i)throw new Error("accountId is required");if(!n)throw new Error("youtubeVideoPlayer is required");var o,r,a=window._sf_async_config=window._sf_async_config||{};a.uid=i,a.domain=new URL(t.host.host.url).host,(window._cbv||(window._cbv=[])).push(n),o=document.createElement("script"),r=document.getElementsByTagName("script")[0],o.type="text/javascript",o.async=!0,o.src="//static.chartbeat.com/js/chartbeat_video.js",r.parentNode.insertBefore(o,r)}},s=n(567);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return c="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},c(e,t,n||e)}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var y="YouTubeLoadTime",v="YouTubeTTFF",b=[],w={2:"The request contains an invalid parameter value.",5:"The requested content cannot be played in an HTML5 player.",100:"The requested video was not found.",101:"The video owner does not allow it to be played in embedded players.",150:"The video owner does not allow it to be played in embedded players."},g=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(g,e);var t,n,i,h=l(g);function g(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(n=h.call(this,e,t)).embedConfig="",n.videoIndex=0,n.resetState(),n.options=Object(r.b)({controls:1,modestbranding:1,rel:0,showInfo:0,timedEvents:{},start:t.params.start_time||0},t.params),n.options.autoplay=n.autoplayVideo,n.video.ytpp_enabled&&(n.embedConfig=JSON.stringify({autonavRelatedVideos:n.video.continuous_play_enabled,disableRelatedVideos:!n.video.continuous_play_enabled,relatedChannels:m(n.video.provider_class,n.video.youtube_channel),relatedVideos:n.video.continuous_play_enabled?n.video.youtube_playlist_ids:[],adsConfig:{nonPersonalizedAd:!n.allowPersonalizedCookies(),disableAds:!n.allowPersonalizedCookies()}}),delete n.options.rel),n.asset.parsely_site_id&&n.allowPersonalizedCookies()&&(n.parsely=new s.a(f(n))),n}return t=g,(n=[{key:"load",value:function(){this.mark(y),this.api()?this.build():(window.onYouTubeIframeAPIReady||(window.onYouTubeIframeAPIReady=function(){return b.forEach((function(e){return e.build()}))},Object(r.d)("//www.youtube.com/iframe_api")),b.push(this))}},{key:"api",value:function(){return window.YT}},{key:"build",value:function(){var e=this;if(!this.player){var t=this.api();this.player=new t.Player(this.el.id,{videoId:this.video.youtube_id||this.video.provider_video_id,host:this.allowPersonalizedCookies()?"https://www.youtube.com":"https://www.youtube-nocookie.com",playerVars:this.options,embedConfig:this.embedConfig,adsConfig:this.adsConfig,events:{onReady:function(t){e.asset.chartbeat_account_id&&e.allowPersonalizedCookies()&&(e.chartbeat=new a(e,t.target)),e.trackTimeSinceMark(o.a.LOAD_TIME,y),e.resetState(),e.el.addEventListener("playTimeUpdate",(function(){e.trackQuartiles(),e.trackThresholds()})),e.autoplayVideo&&e.onStart()},onStateChange:function(n){switch(n.data){case t.PlayerState.UNSTARTED:return e.onStart();case t.PlayerState.PLAYING:return e.onPlaying();case t.PlayerState.ENDED:return e.onEnded();case t.PlayerState.PAUSED:return e.onPaused()}},onError:function(t){e.track({action:o.a.ERROR,value:t.data,index:e.videoIndex,message:w[t.data]||"Unknown error."})}},width:"100%",height:"100%"})}}},{key:"resetState",value:function(){this.player&&(this.youtubeId=this.player.getVideoData().video_id),this.currentQuartile=0,this.watchedSeconds=0,this.currentThreshold=0,this.eventQueue=[],this.staleVideo=!1}},{key:"onStart",value:function(){this.firstPlayTriggered||0!==this.videoIndex||(this.mark(v),this.firstPlayTriggered=!0,this.track({action:o.a.PLAY}))}},{key:"onPlaying",value:function(){this.pauseOtherPlayers(),this.timeStart(),this.played&&this.youtubeId!==this.player.getVideoData().video_id&&this.relatedVideoStart(),this.played||0!==this.videoIndex||(this.trackTimeSinceMark(o.a.TTFF,v),this.played=!0,this.track({action:o.a.START,value:this.duration(),index:this.videoIndex}))}},{key:"onEnded",value:function(){this.timeStop(),this.watchedSeconds=0,this.track({action:o.a.COMPLETE,value:Math.floor(.25*this.player.getDuration()),index:this.videoIndex})}},{key:"onPaused",value:function(){this.timeStop()}},{key:"track",value:function(e){this.staleVideo?this.eventQueue.shift(e):c(p(g.prototype),"track",this).call(this,e)}},{key:"relatedVideoStart",value:function(){this.videoIndex=this.videoIndex+1,this.resetState(),this.setVideoByYoutubeId(this.youtubeId)}},{key:"setVideoByYoutubeId",value:function(e){var t=this;this.staleVideo=!0;var n=new XMLHttpRequest;n.open("GET","/api/videos/by_platform_id/youtube/"+e,!0),n.onload=function(){200===n.status?t.video=JSON.parse(n.responseText):t.video=t.getNonVolumeRelatedVideo()},n.onerror=function(){t.video=t.getNonVolumeRelatedVideo()},n.onloadend=function(){t.staleVideo=!1,Object(r.e)("SENDING "+t.eventQueue.length+" queued events."),t.eventQueue.forEach((function(e){return t.track(e)})),t.eventQueue.length=0,t.track({action:o.a.START,value:t.duration(),index:t.videoIndex})},n.send()}},{key:"getNonVolumeRelatedVideo",value:function(){return{id:0,title_short:this.player.getVideoData().title,description_short:this.player.getVideoData().description,youtube_id:this.player.getVideoData().video_id}}},{key:"duration",value:function(){return this.player?this.player.getDuration():0}},{key:"percentComplete",value:function(){return this.player?this.player.getCurrentTime()/this.duration()*100:0}},{key:"quartileValue",value:function(){var e=this.duration()/4;return e>1?Math.floor(e):Object(r.c)(e)}},{key:"trackQuartiles",value:function(){var e=this.percentComplete();e>=75&&2===this.currentQuartile?(this.currentQuartile=3,this.track({action:o.a.THIRD_QUARTILE,value:this.quartileValue(),index:this.videoIndex})):e>=50&&1===this.currentQuartile?(this.currentQuartile=2,this.track({action:o.a.SECOND_QUARTILE,value:this.quartileValue(),index:this.videoIndex})):e>=25&&0===this.currentQuartile&&(this.currentQuartile=1,this.track({action:o.a.FIRST_QUARTILE,value:this.quartileValue(),index:this.videoIndex}))}},{key:"trackThresholds",value:function(){this.currentThreshold<3&&this.watchedSeconds>=3&&(this.currentThreshold=3,this.track({action:o.a.THREE_SECONDS,value:3,index:this.videoIndex})),this.currentThreshold<10&&this.watchedSeconds>=10&&(this.currentThreshold=10,this.track({action:o.a.TEN_SECONDS,value:10,index:this.videoIndex})),this.currentThreshold<30&&this.watchedSeconds>=30&&(this.currentThreshold=30,this.track({action:o.a.THIRTY_SECONDS,value:30,index:this.videoIndex}))}},{key:"play",value:function(){this.player&&this.player.playVideo()}},{key:"pause",value:function(){this.player&&this.player.stopVideo()}},{key:"destroy",value:function(){this.player&&this.player.destroy()}},{key:"unmute",value:function(){this.player&&this.player.unMute()}}])&&u(t.prototype,n),i&&u(t,i),g}(i.a);function m(e,t){var n={verge:["txJFU9DgUhfr2J2bveCHkQ"],"vrg-sci":["ddiUEpeqJcYeBxX1IVBKvQ"],polygon:["Dqau170byfm1ksTQ0jYNpg"],"polygon-guides":["uVxaQDraOja6xKidcmoufA"]};"UC"===t.substring(0,2)&&(t=t.substring(2));var i=[t];return e in n&&(i=i.concat(n[e])),i}t.default=g}}]);
//# sourceMappingURL=embed-youtube-cba291aee4f91a4530d8.chunk.js.map