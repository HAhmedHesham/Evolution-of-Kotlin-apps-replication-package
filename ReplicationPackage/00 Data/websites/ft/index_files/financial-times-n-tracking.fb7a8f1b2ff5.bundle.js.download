(window.webpackJsonp=window.webpackJsonp||[]).push([["financial-times-n-tracking"],{d2988f39:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"SPOOR_API_INGEST_URL",(function(){return M})),n.d(e,"broadcast",(function(){return y})),n.d(e,"init",(function(){return j})),n.d(e,"trackers",(function(){return I}));var i=n("6d73a2e3"),o=n("efe87a17"),r=n("939738f6"),a=n.n(r),s=n("b4722769");function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var m={appName:"app",contentId:"rootContentId",contentType:"rootContentType",conceptId:"rootConceptId",conceptType:"rootConceptType",segmentid:"marketing_segment_id",cpccampaign:"cpc_campaign",abTestState:"active_ammit_flags"};function g(t){var e={};return Object.keys(t).forEach((function(n){var i=t[n];"abTestState"===n&&(i=function(t){var e={};return t.split(",").map((function(t){var n=p(t.split(":"),2),i=n[0],o=n[1];i&&o&&(e[i]=o)})),e}(i)),"contentId"===n&&(e.content=f(f({},e.content),{},{uuid:i})),"contentType"===n&&(e.content=f(f({},e.content),{},{asset_type:i})),e[m[n]||n]=i})),e}function y(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Element.prototype.isPrototypeOf(this)?this:document.body,o=new CustomEvent(t,{bubbles:n,cancelable:!0,detail:e});i.dispatchEvent(o)}var w=function(){function t(t){var e=this;if(void 0===t&&(t={}),this.config={cumulativeLayoutShift:!1,dataConsumption:!1,resourceTiming:!1,analyticsTracker:function(t){},logPrefix:"Perfume.js:",logging:!0,maxMeasureTime:15e3},this.t="© 2020 Leonardo Zizzamia",this.version="4.8.1",this.c=window.console,this.i=0,this.d=document,this.s=!1,this.h=0,this.o="Recording already",this.u={},this.m={},this.v={beacon:0,css:0,fetch:0,img:0,other:0,script:0,total:0,xmlhttprequest:0},this.w=window,this.l=window.performance,this.p=window.navigator,this.g="4g",this.T=!1,this.k=function(){e.d.hidden&&(e.s=e.d.hidden)},this.config=Object.assign({},this.config,t),this._()){if(this.N())try{this.I()}catch(t){this.config.logging&&this.c.warn(this.config.logPrefix,t)}this.L(),this.P("navigationTiming",this.j()),this.P("networkInformation",this.C())}}return Object.defineProperty(t.prototype,"isLowEndDevice",{get:function(){return!!(this.p.hardwareConcurrency&&this.p.hardwareConcurrency<=4)||!!(this.p.deviceMemory&&this.p.deviceMemory<=4)},O:!0,S:!0}),Object.defineProperty(t.prototype,"isLowEndExperience",{get:function(){return!!this.isLowEndDevice||!!["slow-2g","2g","3g"].includes(this.g)||!!this.T},O:!0,S:!0}),t.prototype.start=function(t){this._()&&(this.u[t]?this.D(this.o+" started."):(this.u[t]=!0,this.l.mark("mark_"+t+"_start"),this.s=!1))},t.prototype.end=function(t,e){var n=this;if(void 0===e&&(e={}),this._())if(this.u[t]){this.l.mark("mark_"+t+"_end");var i=this.F(t),o=parseFloat(i.toFixed(2));delete this.u[t],this.q((function(){var i=n.M();i.isLowEndDevice=n.isLowEndDevice,i.isLowEndExperience=n.isLowEndExperience;var r={W:t,data:o,duration:o,B:e,R:i};n.log(r),n.Z(r)}))}else this.D(this.o+" stopped.")},t.prototype.endPaint=function(t,e){var n=this;setTimeout((function(){n.end(t,e)}))},t.prototype.clear=function(t){this.l.clearMarks("mark_"+t+"_start"),this.l.clearMarks("mark_"+t+"_end"),delete this.u[t]},t.prototype.A=function(t){this.G({H:t,W:"firstInputDelay",J:"duration"}),this.K(),this.U()},t.prototype.U=function(){this.V&&(clearTimeout(this.V),this.V=void 0,this.P("dataConsumption",this.v))},t.prototype.K=function(){this.m.X&&this.h&&(this.Y(this.h,"largestContentfulPaint"),this.m.X.disconnect()),this.m.$&&this.i>0&&(this.m.$.takeRecords(),this.Y(this.i,"cumulativeLayoutShiftScore",""),this.m.$.disconnect())},t.prototype.tt=function(){this.m.it=this.st("first-input",this.A.bind(this))},t.prototype.nt=function(){var t=this;this.m.et=this.st("paint",(function(e){t.G({H:e,rt:"first-paint",W:"firstPaint",J:"startTime"}),t.G({H:e,rt:"first-contentful-paint",W:"firstContentfulPaint",J:"startTime"})}))},t.prototype.ht=function(){var t=this;this.m.X=this.st("largest-contentful-paint",(function(e){var n=e.pop();n&&(t.h=n.renderTime||n.loadTime)}))},t.prototype.at=function(){var t=this;this.m.$=this.st("layout-shift",(function(e){var n=e.pop();n&&!n.ot&&n.value&&(t.i+=n.value)}))},t.prototype.I=function(){this.nt(),this.tt(),this.ht(),(this.config.resourceTiming||this.config.dataConsumption)&&this.ut(),this.at()},t.prototype.ut=function(){var t=this;this.st("resource",(function(e){t.ft({H:e})})),this.V=setTimeout((function(){t.U()}),15e3)},t.prototype._=function(){return this.l&&!!this.l.getEntriesByType&&!!this.l.now&&!!this.l.mark},t.prototype.N=function(){return this.w.chrome&&"PerformanceObserver"in this.w},t.prototype.ct=function(t){var e=this.l.getEntriesByName(t),n=e[e.length-1];return n&&"measure"===n.entryType?n.duration:-1},t.prototype.M=function(){return this.p?{deviceMemory:this.p.deviceMemory?this.p.deviceMemory:0,hardwareConcurrency:this.p.hardwareConcurrency?this.p.hardwareConcurrency:0,serviceWorkerStatus:"serviceWorker"in this.p?this.p.serviceWorker.controller?"controlled":"supported":"unsupported"}:{}},t.prototype.j=function(){if(!this._())return{};var t=performance.getEntriesByType("navigation")[0];if(!t)return{};var e=t.responseStart,n=t.responseEnd;return{fetchTime:n-t.fetchStart,workerTime:t.workerStart>0?n-t.workerStart:0,totalTime:n-t.requestStart,downloadTime:n-e,timeToFirstByte:e-t.requestStart,headerSize:t.transferSize-t.encodedBodySize||0,dnsLookupTime:t.domainLookupEnd-t.domainLookupStart}},t.prototype.C=function(){if("connection"in this.p){var t=this.p.connection;return"object"!=typeof t?{}:(this.g=t.effectiveType,this.T=!!t.saveData,{downlink:t.downlink,effectiveType:t.effectiveType,rtt:t.rtt,saveData:!!t.saveData})}return{}},t.prototype.P=function(t,e){var n=this;Object.keys(e).forEach((function(t){"number"==typeof e[t]&&(e[t]=parseFloat(e[t].toFixed(2)))}));var i=this.M();i.isLowEndDevice=this.isLowEndDevice,i.isLowEndExperience=this.isLowEndExperience,this.q((function(){n.log({W:t,data:e,R:i}),n.Z({W:t,data:e,R:i})}))},t.prototype.Y=function(t,e,n){var i=this;void 0===n&&(n="ms");var o=parseFloat(t.toFixed(2));if(!(o>this.config.maxMeasureTime||o<=0)){var r=this.M();r.isLowEndDevice=this.isLowEndDevice,r.isLowEndExperience=this.isLowEndExperience,this.q((function(){i.log({W:e,data:o+" "+n,R:r}),i.Z({W:e,duration:o,R:r})}))}},t.prototype.log=function(t){!this.s&&this.config.logging&&this.c.log("%c "+this.config.logPrefix+" "+t.W+" ","color:#ff6d00;font-size:11px;",t.data,t.R)},t.prototype.D=function(t){this.config.logging&&this.c.warn(this.config.logPrefix,t)},t.prototype.L=function(){void 0!==this.d.hidden&&this.d.addEventListener("visibilitychange",this.k)},t.prototype.F=function(t){var e="mark_"+t+"_start",n="mark_"+t+"_end";return this.l.measure(t,e,n),this.ct(t)},t.prototype.st=function(t,e){return this.vt=new PerformanceObserver((function(t){var n=t.getEntries();e(n)})),this.vt.observe({type:t,buffered:!0}),this.vt},t.prototype.G=function(t){var e=this;t.H.forEach((function(n){(!t.rt||t.rt&&n.name===t.rt)&&e.Y(n[t.J],t.W),e.m.et&&"first-contentful-paint"===n.name&&e.m.et.disconnect()})),this.m.it&&"firstInputDelay"===t.W&&this.m.it.disconnect()},t.prototype.ft=function(t){var e=this;t.H.forEach((function(t){if(e.config.resourceTiming&&e.P("resourceTiming",t),e.config.dataConsumption&&t.decodedBodySize&&t.initiatorType){var n=t.decodedBodySize/1e3;e.v[t.initiatorType]+=n,e.v.total+=n}}))},t.prototype.q=function(t){"requestIdleCallback"in this.w?this.w.requestIdleCallback(t,{timeout:3e3}):t()},t.prototype.Z=function(t){if(!this.s){var e=t.W,n=t.data,i=t.duration,o=t.B,r=t.R,a=o||{};this.config.analyticsTracker({metricName:e,data:n,duration:i,eventProperties:a,navigatorInformation:r})}},t}(),b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};var T=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){var e=[],n=void 0===b?window:b,i=Math.pow(256,6),o=Math.pow(2,52),r=2*o,a=Math.random;function s(t){var e,n=t.length,i=this,o=0,r=i.i=i.j=0,a=i.S=[];for(n||(t=[n++]);o<256;)a[o]=o++;for(o=0;o<256;o++)a[o]=a[r=255&r+t[o%n]+(e=a[o])],a[r]=e;(i.g=function(t){for(var e,n=0,o=i.i,r=i.j,a=i.S;t--;)e=a[o=255&o+1],n=256*n+a[255&(a[o]=a[r=255&r+e])+(a[r]=e)];return i.i=o,i.j=r,n})(256)}function c(t,e){var n,i=[],o=(typeof t)[0];if(e&&"o"==o)for(n in t)try{i.push(c(t[n],e-1))}catch(t){}return i.length?i:"s"==o?t:t+"\0"}function u(t,e){for(var n,i=t+"",o=0;o<i.length;)e[255&o]=255&(n^=19*e[255&o])+i.charCodeAt(o++);return d(e)}function h(t){try{return n.crypto.getRandomValues(t=new Uint8Array(256)),d(t)}catch(t){return[+new Date,n,n.navigator&&n.navigator.plugins,n.screen,d(e)]}}function d(t){return String.fromCharCode.apply(0,t)}t.exports=function(n,a){if(a&&!0===a.global)return a.global=!1,Math.random=t.exports(n,a),a.global=!0,Math.random;var f=a&&a.entropy||!1,l=[],p=(u(c(f?[n,d(e)]:0 in arguments?n:h(),3),l),new s(l));return u(d(p.S),e),function(){for(var t=p.g(6),e=i,n=0;t<o;)t=256*(t+n),e*=256,n=p.g(1);for(;t>=r;)t/=2,e/=2,n>>>=1;return(t+n)/e}},t.exports.resetGlobal=function(){Math.random=a},u(Math.random(),e)}));T.resetGlobal;var E=["domInteractive","domComplete","timeToFirstByte","firstPaint","largestContentfulPaint","firstInputDelay"],k=[25,50,75,100],A={onScroll:function(){},target:"body",debug:!1},S=function(){function t(e){c(this,t),this.options=f(f({},A),e),this.init()}return h(t,[{key:"init",value:function(){var t=this,e=document.querySelector(this.options.target);e&&"IntersectionObserver"in window&&(this.observer=new IntersectionObserver(this.handleIntersection.bind(this)),e.style.position="relative",k.forEach((function(n){var i=document.createElement("div");i.className="n-tracking-scroll-depth-marker",i.style.position="absolute",i.style.top="".concat(n,"%"),i.style.bottom="0",i.style.width="100%",i.style.zIndex="-1",i.setAttribute("data-scroll-depth",n),e.appendChild(i),t.observer.observe(i)})))}},{key:"handleIntersection",value:function(t){var e=this;t.forEach((function(t){if(t.isIntersecting||t.intersectionRatio>0){var n=t.target,i=n.getAttribute("data-scroll-depth");e.options.onScroll(i),e.options.debug&&console.log("ScrollDepth",{marker:i}),n.parentNode&&n.parentNode.removeChild(n),e.observer.unobserve(n)}}))}}]),t}(),x=["load","click","focus","scroll","mousemove","touchstart","touchend","touchcancel","touchleave"],C=["blur"],O=["beforeunload","unload","pagehide"],P={onExit:function(){},debug:!1},L=function(){function t(e){c(this,t),this.options=f(f({},P),e),this.totalAttentionTime=0,this.hasExited=!1,this.init()}return h(t,[{key:"init",value:function(){var t=this;x.forEach((function(e){window.addEventListener(e,t.startAttention.bind(t))})),C.forEach((function(e){window.addEventListener(e,t.endAttention.bind(t))})),O.forEach((function(e){window.addEventListener(e,t.handleExit.bind(t))})),document.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this)),document.querySelectorAll("video").forEach((function(e){e.addEventListener("playing",t.startConstantAttention.bind(t)),e.addEventListener("pause",t.endConstantAttention.bind(t)),e.addEventListener("ended",t.endConstantAttention.bind(t))}))}},{key:"startAttention",value:function(t){clearTimeout(this.attentionTimeout),this.startAttentionTime||(this.startAttentionTime=Date.now()),this.attentionTimeout=setTimeout(this.endAttention.bind(this,{type:"timeout"}),15e3),this.options.debug&&console.log("AttentionTime start",{event:t.type})}},{key:"endAttention",value:function(t){this.startAttentionTime&&(clearTimeout(this.attentionTimeout),this.totalAttentionTime=this.getAttentionTime(),this.startAttentionTime=null),this.options.debug&&console.log("AttentionTime end",{event:t.type,time:this.totalAttentionTime})}},{key:"startConstantAttention",value:function(){this.constantAttentionInterval=setInterval(this.startAttention.bind(this),15e3)}},{key:"endConstantAttention",value:function(t){this.endAttention(t),clearInterval(this.constantAttentionInterval)}},{key:"getAttentionTime",value:function(){var t=0;return this.startAttentionTime&&(t=Math.round((Date.now()-this.startAttentionTime)/1e3)),this.totalAttentionTime+t}},{key:"handleVisibilityChange",value:function(t){"hidden"===document.visibilityState?this.endAttention(t):this.startAttention(t)}},{key:"handleExit",value:function(t){this.hasExited||(this.endAttention(t),this.options.debug&&console.log("AttentionTime",{event:t.type,time:this.totalAttentionTime}),this.options.onExit(this.totalAttentionTime),this.hasExited=!0)}}]),t}(),I=Object.freeze({__proto__:null,realUserMonitoringForPerformance:function(){if(!(!1 in window)){var t,e=(t=document.cookie&&document.cookie.match(/spoor-id=([^;]+)/))?t[1]:null;if(n=5,i=T(e)(),Math.round(100*i)<=n){var n,i,o=performance.getEntriesByType("navigation")[0];if("navigate"===o.type){var r={};s.default.complete.then((function(){r.domInteractive=Math.round(o.domInteractive),r.domComplete=Math.round(o.domComplete)}));var a=!1;new w({analyticsTracker:function(t){var e=t.metricName,n=t.duration,i=t.data;a||(n&&(r[e]=Math.round(n)),"navigationTiming"===e&&(r.timeToFirstByte=Math.round(i.timeToFirstByte)),function(t){return E.every((function(e){return"number"==typeof t[e]}))}(r)&&(console.log({performanceMetrics:r}),y("oTracking.event",{action:"performance",category:"page",context:r}),a=!0))},logging:!1,largestContentfulPaint:!0})}}}},pageAttention:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=function(t){y("oTracking.event",{category:"page",action:"interaction",context:{attention:{total:t}}})},n=new L(f(f({},t),{},{onExit:e})),i=function(t){y("oTracking.event",{category:"page",action:"scrolldepth",meta:{percentagesViewed:t,attention:n.getAttentionTime()}})};new S(f(f({},t),{},{onScroll:i}))},textCopying:function(){document.addEventListener("copy",(function(t){var e={nodeName:t.target.nodeName.toLowerCase()};if(window.getSelection){var n=window.getSelection().toString().trim();e.characters=n.length,e.words=n.split(/\s+/).length,e.selection=function(t){if(t.length>100){var e=100-" … ".length,n=Math.floor(e/2),i=Math.ceil(e/2);return t.substr(0,n)+" … "+t.substr(-1*i)}return t}(n)}y("oTracking.event",{action:"copy",category:"text",context:e})}))}}),M="https://spoor-api.ft.com/ingest";function j(t){var e,n=t.appContext,r=t.extraContext,s=t.pageViewContext,c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,e={},n=["segmentid","cpccampaign"],i=new URLSearchParams(t);return n.forEach((function(t){var n=i.get(t);n&&(e[t]=n)})),e}(),u={server:M,context:g(f(f(f({},c),n),r)),user:(e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,{layout:o.default.getCurrentLayout(),orientation:a.a.getOrientation(),connectionType:e?e.type:void 0}),useSendBeacon:!0};if(i.default.init(u),window===window.top||"errors-next.ft.com"===window.location.hostname){var h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,e=new URLSearchParams(t),n=e.get("nextErrorStatus"),i=e.get("nextErrorReason");if(n||i)return{errorStatus:n,errorReason:i,url:window.parent.location.toString(),referrer:window.parent.document.referrer}}();i.default.page(f(f({},h),s))}return i.default.click.init("cta"),i.default}}.call(this,n("fcdffa92"))},d2988f39:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"SPOOR_API_INGEST_URL",(function(){return j})),n.d(e,"broadcast",(function(){return w})),n.d(e,"init",(function(){return _})),n.d(e,"trackers",(function(){return M}));var i=n("0887d82c"),o=n.n(i),r=n("efe87a17"),a=n("939738f6"),s=n.n(a),c=n("b4722769");function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var g={appName:"app",contentId:"rootContentId",contentType:"rootContentType",conceptId:"rootConceptId",conceptType:"rootConceptType",segmentid:"marketing_segment_id",cpccampaign:"cpc_campaign",abTestState:"active_ammit_flags"};function y(t){var e={};return Object.keys(t).forEach((function(n){var i=t[n];"abTestState"===n&&(i=function(t){var e={};return t.split(",").map((function(t){var n=v(t.split(":"),2),i=n[0],o=n[1];i&&o&&(e[i]=o)})),e}(i)),"contentId"===n&&(e.content=l(l({},e.content),{},{uuid:i})),"contentType"===n&&(e.content=l(l({},e.content),{},{asset_type:i})),e[g[n]||n]=i})),e}function w(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Element.prototype.isPrototypeOf(this)?this:document.body,o=new CustomEvent(t,{bubbles:n,cancelable:!0,detail:e});i.dispatchEvent(o)}var b=function(){function t(t){var e=this;if(void 0===t&&(t={}),this.config={cumulativeLayoutShift:!1,dataConsumption:!1,resourceTiming:!1,analyticsTracker:function(t){},logPrefix:"Perfume.js:",logging:!0,maxMeasureTime:15e3},this.t="© 2020 Leonardo Zizzamia",this.version="4.8.1",this.c=window.console,this.i=0,this.d=document,this.s=!1,this.h=0,this.o="Recording already",this.u={},this.m={},this.v={beacon:0,css:0,fetch:0,img:0,other:0,script:0,total:0,xmlhttprequest:0},this.w=window,this.l=window.performance,this.p=window.navigator,this.g="4g",this.T=!1,this.k=function(){e.d.hidden&&(e.s=e.d.hidden)},this.config=Object.assign({},this.config,t),this._()){if(this.N())try{this.I()}catch(t){this.config.logging&&this.c.warn(this.config.logPrefix,t)}this.L(),this.P("navigationTiming",this.j()),this.P("networkInformation",this.C())}}return Object.defineProperty(t.prototype,"isLowEndDevice",{get:function(){return!!(this.p.hardwareConcurrency&&this.p.hardwareConcurrency<=4)||!!(this.p.deviceMemory&&this.p.deviceMemory<=4)},O:!0,S:!0}),Object.defineProperty(t.prototype,"isLowEndExperience",{get:function(){return!!this.isLowEndDevice||!!["slow-2g","2g","3g"].includes(this.g)||!!this.T},O:!0,S:!0}),t.prototype.start=function(t){this._()&&(this.u[t]?this.D(this.o+" started."):(this.u[t]=!0,this.l.mark("mark_"+t+"_start"),this.s=!1))},t.prototype.end=function(t,e){var n=this;if(void 0===e&&(e={}),this._())if(this.u[t]){this.l.mark("mark_"+t+"_end");var i=this.F(t),o=parseFloat(i.toFixed(2));delete this.u[t],this.q((function(){var i=n.M();i.isLowEndDevice=n.isLowEndDevice,i.isLowEndExperience=n.isLowEndExperience;var r={W:t,data:o,duration:o,B:e,R:i};n.log(r),n.Z(r)}))}else this.D(this.o+" stopped.")},t.prototype.endPaint=function(t,e){var n=this;setTimeout((function(){n.end(t,e)}))},t.prototype.clear=function(t){this.l.clearMarks("mark_"+t+"_start"),this.l.clearMarks("mark_"+t+"_end"),delete this.u[t]},t.prototype.A=function(t){this.G({H:t,W:"firstInputDelay",J:"duration"}),this.K(),this.U()},t.prototype.U=function(){this.V&&(clearTimeout(this.V),this.V=void 0,this.P("dataConsumption",this.v))},t.prototype.K=function(){this.m.X&&this.h&&(this.Y(this.h,"largestContentfulPaint"),this.m.X.disconnect()),this.m.$&&this.i>0&&(this.m.$.takeRecords(),this.Y(this.i,"cumulativeLayoutShiftScore",""),this.m.$.disconnect())},t.prototype.tt=function(){this.m.it=this.st("first-input",this.A.bind(this))},t.prototype.nt=function(){var t=this;this.m.et=this.st("paint",(function(e){t.G({H:e,rt:"first-paint",W:"firstPaint",J:"startTime"}),t.G({H:e,rt:"first-contentful-paint",W:"firstContentfulPaint",J:"startTime"})}))},t.prototype.ht=function(){var t=this;this.m.X=this.st("largest-contentful-paint",(function(e){var n=e.pop();n&&(t.h=n.renderTime||n.loadTime)}))},t.prototype.at=function(){var t=this;this.m.$=this.st("layout-shift",(function(e){var n=e.pop();n&&!n.ot&&n.value&&(t.i+=n.value)}))},t.prototype.I=function(){this.nt(),this.tt(),this.ht(),(this.config.resourceTiming||this.config.dataConsumption)&&this.ut(),this.at()},t.prototype.ut=function(){var t=this;this.st("resource",(function(e){t.ft({H:e})})),this.V=setTimeout((function(){t.U()}),15e3)},t.prototype._=function(){return this.l&&!!this.l.getEntriesByType&&!!this.l.now&&!!this.l.mark},t.prototype.N=function(){return this.w.chrome&&"PerformanceObserver"in this.w},t.prototype.ct=function(t){var e=this.l.getEntriesByName(t),n=e[e.length-1];return n&&"measure"===n.entryType?n.duration:-1},t.prototype.M=function(){return this.p?{deviceMemory:this.p.deviceMemory?this.p.deviceMemory:0,hardwareConcurrency:this.p.hardwareConcurrency?this.p.hardwareConcurrency:0,serviceWorkerStatus:"serviceWorker"in this.p?this.p.serviceWorker.controller?"controlled":"supported":"unsupported"}:{}},t.prototype.j=function(){if(!this._())return{};var t=performance.getEntriesByType("navigation")[0];if(!t)return{};var e=t.responseStart,n=t.responseEnd;return{fetchTime:n-t.fetchStart,workerTime:t.workerStart>0?n-t.workerStart:0,totalTime:n-t.requestStart,downloadTime:n-e,timeToFirstByte:e-t.requestStart,headerSize:t.transferSize-t.encodedBodySize||0,dnsLookupTime:t.domainLookupEnd-t.domainLookupStart}},t.prototype.C=function(){if("connection"in this.p){var t=this.p.connection;return"object"!=typeof t?{}:(this.g=t.effectiveType,this.T=!!t.saveData,{downlink:t.downlink,effectiveType:t.effectiveType,rtt:t.rtt,saveData:!!t.saveData})}return{}},t.prototype.P=function(t,e){var n=this;Object.keys(e).forEach((function(t){"number"==typeof e[t]&&(e[t]=parseFloat(e[t].toFixed(2)))}));var i=this.M();i.isLowEndDevice=this.isLowEndDevice,i.isLowEndExperience=this.isLowEndExperience,this.q((function(){n.log({W:t,data:e,R:i}),n.Z({W:t,data:e,R:i})}))},t.prototype.Y=function(t,e,n){var i=this;void 0===n&&(n="ms");var o=parseFloat(t.toFixed(2));if(!(o>this.config.maxMeasureTime||o<=0)){var r=this.M();r.isLowEndDevice=this.isLowEndDevice,r.isLowEndExperience=this.isLowEndExperience,this.q((function(){i.log({W:e,data:o+" "+n,R:r}),i.Z({W:e,duration:o,R:r})}))}},t.prototype.log=function(t){!this.s&&this.config.logging&&this.c.log("%c "+this.config.logPrefix+" "+t.W+" ","color:#ff6d00;font-size:11px;",t.data,t.R)},t.prototype.D=function(t){this.config.logging&&this.c.warn(this.config.logPrefix,t)},t.prototype.L=function(){void 0!==this.d.hidden&&this.d.addEventListener("visibilitychange",this.k)},t.prototype.F=function(t){var e="mark_"+t+"_start",n="mark_"+t+"_end";return this.l.measure(t,e,n),this.ct(t)},t.prototype.st=function(t,e){return this.vt=new PerformanceObserver((function(t){var n=t.getEntries();e(n)})),this.vt.observe({type:t,buffered:!0}),this.vt},t.prototype.G=function(t){var e=this;t.H.forEach((function(n){(!t.rt||t.rt&&n.name===t.rt)&&e.Y(n[t.J],t.W),e.m.et&&"first-contentful-paint"===n.name&&e.m.et.disconnect()})),this.m.it&&"firstInputDelay"===t.W&&this.m.it.disconnect()},t.prototype.ft=function(t){var e=this;t.H.forEach((function(t){if(e.config.resourceTiming&&e.P("resourceTiming",t),e.config.dataConsumption&&t.decodedBodySize&&t.initiatorType){var n=t.decodedBodySize/1e3;e.v[t.initiatorType]+=n,e.v.total+=n}}))},t.prototype.q=function(t){"requestIdleCallback"in this.w?this.w.requestIdleCallback(t,{timeout:3e3}):t()},t.prototype.Z=function(t){if(!this.s){var e=t.W,n=t.data,i=t.duration,o=t.B,r=t.R,a=o||{};this.config.analyticsTracker({metricName:e,data:n,duration:i,eventProperties:a,navigatorInformation:r})}},t}(),T="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};var E=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){var e=[],n=void 0===T?window:T,i=Math.pow(256,6),o=Math.pow(2,52),r=2*o,a=Math.random;function s(t){var e,n=t.length,i=this,o=0,r=i.i=i.j=0,a=i.S=[];for(n||(t=[n++]);o<256;)a[o]=o++;for(o=0;o<256;o++)a[o]=a[r=255&r+t[o%n]+(e=a[o])],a[r]=e;(i.g=function(t){for(var e,n=0,o=i.i,r=i.j,a=i.S;t--;)e=a[o=255&o+1],n=256*n+a[255&(a[o]=a[r=255&r+e])+(a[r]=e)];return i.i=o,i.j=r,n})(256)}function c(t,e){var n,i=[],o=(typeof t)[0];if(e&&"o"==o)for(n in t)try{i.push(c(t[n],e-1))}catch(t){}return i.length?i:"s"==o?t:t+"\0"}function u(t,e){for(var n,i=t+"",o=0;o<i.length;)e[255&o]=255&(n^=19*e[255&o])+i.charCodeAt(o++);return d(e)}function h(t){try{return n.crypto.getRandomValues(t=new Uint8Array(256)),d(t)}catch(t){return[+new Date,n,n.navigator&&n.navigator.plugins,n.screen,d(e)]}}function d(t){return String.fromCharCode.apply(0,t)}t.exports=function(n,a){if(a&&!0===a.global)return a.global=!1,Math.random=t.exports(n,a),a.global=!0,Math.random;var f=a&&a.entropy||!1,l=[],p=(u(c(f?[n,d(e)]:0 in arguments?n:h(),3),l),new s(l));return u(d(p.S),e),function(){for(var t=p.g(6),e=i,n=0;t<o;)t=256*(t+n),e*=256,n=p.g(1);for(;t>=r;)t/=2,e/=2,n>>>=1;return(t+n)/e}},t.exports.resetGlobal=function(){Math.random=a},u(Math.random(),e)}));E.resetGlobal;var k=["domInteractive","domComplete","timeToFirstByte","firstPaint","largestContentfulPaint","firstInputDelay"],A=[25,50,75,100],S={onScroll:function(){},target:"body",debug:!1},x=function(){function t(e){u(this,t),this.options=l(l({},S),e),this.init()}return d(t,[{key:"init",value:function(){var t=this,e=document.querySelector(this.options.target);e&&"IntersectionObserver"in window&&(this.observer=new IntersectionObserver(this.handleIntersection.bind(this)),e.style.position="relative",A.forEach((function(n){var i=document.createElement("div");i.className="n-tracking-scroll-depth-marker",i.style.position="absolute",i.style.top="".concat(n,"%"),i.style.bottom="0",i.style.width="100%",i.style.zIndex="-1",i.setAttribute("data-scroll-depth",n),e.appendChild(i),t.observer.observe(i)})))}},{key:"handleIntersection",value:function(t){var e=this;t.forEach((function(t){if(t.isIntersecting||t.intersectionRatio>0){var n=t.target,i=n.getAttribute("data-scroll-depth");e.options.onScroll(i),e.options.debug&&console.log("ScrollDepth",{marker:i}),n.parentNode&&n.parentNode.removeChild(n),e.observer.unobserve(n)}}))}}]),t}(),C=["load","click","focus","scroll","mousemove","touchstart","touchend","touchcancel","touchleave"],O=["blur"],P=["beforeunload","unload","pagehide"],L={onExit:function(){},debug:!1},I=function(){function t(e){u(this,t),this.options=l(l({},L),e),this.totalAttentionTime=0,this.hasExited=!1,this.init()}return d(t,[{key:"init",value:function(){var t=this;C.forEach((function(e){window.addEventListener(e,t.startAttention.bind(t))})),O.forEach((function(e){window.addEventListener(e,t.endAttention.bind(t))})),P.forEach((function(e){window.addEventListener(e,t.handleExit.bind(t))})),document.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this)),document.querySelectorAll("video").forEach((function(e){e.addEventListener("playing",t.startConstantAttention.bind(t)),e.addEventListener("pause",t.endConstantAttention.bind(t)),e.addEventListener("ended",t.endConstantAttention.bind(t))}))}},{key:"startAttention",value:function(t){clearTimeout(this.attentionTimeout),this.startAttentionTime||(this.startAttentionTime=Date.now()),this.attentionTimeout=setTimeout(this.endAttention.bind(this,{type:"timeout"}),15e3),this.options.debug&&console.log("AttentionTime start",{event:t.type})}},{key:"endAttention",value:function(t){this.startAttentionTime&&(clearTimeout(this.attentionTimeout),this.totalAttentionTime=this.getAttentionTime(),this.startAttentionTime=null),this.options.debug&&console.log("AttentionTime end",{event:t.type,time:this.totalAttentionTime})}},{key:"startConstantAttention",value:function(){this.constantAttentionInterval=setInterval(this.startAttention.bind(this),15e3)}},{key:"endConstantAttention",value:function(t){this.endAttention(t),clearInterval(this.constantAttentionInterval)}},{key:"getAttentionTime",value:function(){var t=0;return this.startAttentionTime&&(t=Math.round((Date.now()-this.startAttentionTime)/1e3)),this.totalAttentionTime+t}},{key:"handleVisibilityChange",value:function(t){"hidden"===document.visibilityState?this.endAttention(t):this.startAttention(t)}},{key:"handleExit",value:function(t){this.hasExited||(this.endAttention(t),this.options.debug&&console.log("AttentionTime",{event:t.type,time:this.totalAttentionTime}),this.options.onExit(this.totalAttentionTime),this.hasExited=!0)}}]),t}(),M=Object.freeze({__proto__:null,realUserMonitoringForPerformance:function(){if(!(!1 in window)){var t,e=(t=document.cookie&&document.cookie.match(/spoor-id=([^;]+)/))?t[1]:null;if(n=5,i=E(e)(),Math.round(100*i)<=n){var n,i,o=performance.getEntriesByType("navigation")[0];if("navigate"===o.type){var r={};c.default.complete.then((function(){r.domInteractive=Math.round(o.domInteractive),r.domComplete=Math.round(o.domComplete)}));var a=!1;new b({analyticsTracker:function(t){var e=t.metricName,n=t.duration,i=t.data;a||(n&&(r[e]=Math.round(n)),"navigationTiming"===e&&(r.timeToFirstByte=Math.round(i.timeToFirstByte)),function(t){return k.every((function(e){return"number"==typeof t[e]}))}(r)&&(console.log({performanceMetrics:r}),w("oTracking.event",{action:"performance",category:"page",context:r}),a=!0))},logging:!1,largestContentfulPaint:!0})}}}},pageAttention:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=function(t){w("oTracking.event",{category:"page",action:"interaction",context:{attention:{total:t}}})},n=new I(l(l({},t),{},{onExit:e})),i=function(t){w("oTracking.event",{category:"page",action:"scrolldepth",meta:{percentagesViewed:t,attention:n.getAttentionTime()}})};new x(l(l({},t),{},{onScroll:i}))},textCopying:function(){document.addEventListener("copy",(function(t){var e={nodeName:t.target.nodeName.toLowerCase()};if(window.getSelection){var n=window.getSelection().toString().trim();e.characters=n.length,e.words=n.split(/\s+/).length,e.selection=function(t){if(t.length>100){var e=100-" … ".length,n=Math.floor(e/2),i=Math.ceil(e/2);return t.substr(0,n)+" … "+t.substr(-1*i)}return t}(n)}w("oTracking.event",{action:"copy",category:"text",context:e})}))}}),j="https://spoor-api.ft.com/ingest";function _(t){var e,n=t.appContext,i=t.extraContext,a=t.pageViewContext,c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,e={},n=["segmentid","cpccampaign"],i=new URLSearchParams(t);return n.forEach((function(t){var n=i.get(t);n&&(e[t]=n)})),e}(),u={server:j,context:y(l(l(l({},c),n),i)),user:(e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,{layout:r.default.getCurrentLayout(),orientation:s.a.getOrientation(),connectionType:e?e.type:void 0}),useSendBeacon:!0};if(o.a.init(u),window===window.top||"errors-next.ft.com"===window.location.hostname){var h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,e=new URLSearchParams(t),n=e.get("nextErrorStatus"),i=e.get("nextErrorReason");if(n||i)return{errorStatus:n,errorReason:i,url:window.parent.location.toString(),referrer:window.parent.document.referrer}}();o.a.page(l(l({},h),a))}return o.a.click.init("cta"),o.a}}.call(this,n("fcdffa92"))}}]);
//# sourceMappingURL=financial-times-n-tracking.fb7a8f1b2ff5.bundle.js.map