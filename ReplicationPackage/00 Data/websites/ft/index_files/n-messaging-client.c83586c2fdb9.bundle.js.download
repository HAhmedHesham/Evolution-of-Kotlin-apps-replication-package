(window.webpackJsonp=window.webpackJsonp||[]).push([["n-messaging-client"],{"03f4cdb1":function(t,e,n){var o=n("99a4eb02"),a=n("23c6c18a"),r=function(t){document.body.dispatchEvent(t)},i=function(t){return a[t]?a[t].eventRules:void 0},c=function(){return o.get("nMessagingEventCounter")?JSON.parse(o.get("nMessagingEventCounter")):{}},s=function(t,e){var n=c();return"object"==typeof n[t]&&"number"==typeof n[t][e]?n[t][e]:0},u=function(t,e){var n=c(),a=s(t,e);n[t]=n[t]||{},n[t][e]=a+1;var r=new Date((new Date).getTime()+3e5);o.set("nMessagingEventCounter",n,{domain:"ft.com",expires:r})};t.exports={generateMessageEvent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.messageId,n=t.position,o=t.flag,a=t.trackingContext,c=t.variant;return function(t,s){if(e){var l=Object.assign({category:"n-messaging",action:t,messaging:e,messaging_position:n,messaging_flag:o,messaging_variant:c},a);s&&(l.messaging_action=s);var p=new CustomEvent("oTracking.event",{detail:l,bubbles:!0});r(p);var m=new CustomEvent("oTracking.event",{detail:Object.assign({},l,{category:"component"}),bubbles:!0});r(m),i(e)&&u(e,t)}}},listen:function(t,e,n){t&&t.addEventListener(e,n)},messageEventLimitsBreached:function(t){var e=i(t);return!!e&&Object.keys(e.maxOccurrences).some((function(n){return s(t,event)>=e.maxOccurrences[n]}))}}},"1868bfa5":function(t,e,n){var o={"./bottom/cookie-consent/main":"82da35ea","./bottom/customer-care-call/main":"b8ca0b2d","./bottom/marketing-popup-prompt-sept-apac/main":"9db0abe7","./bottom/marketing-popup-prompt-sept-row/main":"7785725b","./bottom/marketing-popup-prompt/main":"7d373a79","./bottom/post-activation-journey/main":"ab1d36c6","./bottom/remaining-articles/main":"4b589924","./top/anon-subscribe-now/main":"2e48b3ec","./top/myft-disengaged-tooltip/main":"33a19ecd"};function a(t){var e=r(t);return n(e)}function r(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}a.keys=function(){return Object.keys(o)},a.resolve=r,t.exports=a,a.id="1868bfa5"},"23c6c18a":function(t,e){t.exports={licenceJoinPromptSsiClient:{path:"bottom/lazy",lazy:!0},ssiSurvey:{path:"bottom/secondary-school-survey"},cookieConsentA:{path:"bottom/cookie-consent"},cookieConsentB:{path:"bottom/cookie-consent"},cookieConsentC:{path:"bottom/cookie-consent"},marketingPopupPrompt:{path:"bottom/marketing-popup-prompt",lazy:!0,guruQueryString:"offerId=499f84e9-d7fb-f90d-ba6a-9cbb65060a44",trackingContext:{opportunity_type:"marketingPrompt",opportunity_subtype:"discount_33%off"}},marketingPopupPromptSeptApac:{path:"bottom/marketing-popup-prompt-sept-apac",trackingContext:{opportunity_type:"marketingPromptSeptAPAC",opportunity_subtype:"discount_33%off"}},marketingPopupPromptSeptRow:{path:"bottom/marketing-popup-prompt-sept-row",trackingContext:{opportunity_type:"marketingPromptSeptROW",opportunity_subtype:"discount_50%off"}},paymentFailure:{path:"top/payment-failure"},singleTermRenew:{path:"top/renew-single-term-banner"},anonSubscribeNow:{path:"top/anon-subscribe-now",trackingContext:{opportunity_type:"marketingPrompt",opportunity_subtype:"top_trial_splitter"}},printBannerUsa:{path:"top/print-banner-usa",trackingContext:{opportunity_type:"marketingPrompt",opportunity_subtype:"top_trial_splitter_US"}},contentMessage:{path:"bottom/content-message"},myftDisengagedTooltip:{path:"top/myft-disengaged-tooltip",tooltip:!0},tbybInTrialSubscribe:{path:"bottom/tbyb-in-trial-subscribe"},postActivationJourney:{path:"bottom/post-activation-journey"},tbybPostTrialSubscribe:{path:"bottom/tbyb-post-trial-subscribe"},remainingArticlesTest:{path:"bottom/remaining-articles",lazy:!0},customerCareCall:{path:"bottom/customer-care-call"},aberdeenStandardLifeCancellation:{path:"bottom/asi-cancellation"},tryFullAccess:{path:"top/lazy",lazy:!0,guruQueryString:"offerId=41218b9e-c8ae-c934-43ad-71b13fcb4465"},threeMonthsIntroPricePromo:{path:"top/lazy",lazy:!0},digitalIntroSubscriptionPromo:{path:"top/lazy",lazy:!0},climateCapitalFeedback:{path:"top/lazy",lazy:!0},digitalMarketingSeptApac:{path:"top/digital-marketing-sept-apac",trackingContext:{opportunity_type:"marketingPromptSeptAPAC",opportunity_subtype:"discount_33%off"}},digitalMarketingSeptRow:{path:"top/digital-marketing-sept-row",trackingContext:{opportunity_type:"marketingPromptSeptROW",opportunity_subtype:"discount_50%off"}}}},"2b5e386d":function(t,e,n){var o=n("96f50564"),a=n("9b6503ab"),r=n("b88707c7"),i=n("23c6c18a");t.exports={init:function(){var t=this,e=document.querySelectorAll("[data-n-messaging-slot]"),n=e&&Array.prototype.slice.call(e).map((function(t){var e=t.dataset||{},n=i[e.nMessagingName];return{slot:e.nMessagingSlot,name:e.nMessagingName,content:t.querySelector("[data-n-messaging-component]"),path:n.path,component:n.component,lazy:n.lazy,guruQueryString:n.guruQueryString,trackingContext:n.trackingContext}}));n.length>0&&Promise.all(n.map((function(e){return t.initialiseMessage(e)}))).catch(this.handleError)},initialiseMessage:function(t){var e=this.setupHandler(t.component||t.path);if("bottom/cookie-consent"===t.path)return e(t);var n=this.renderHandler(t.slot);return(t.lazy?o(t):Promise.resolve(null)).then((function(n){return{config:t,guruResult:n,customSetup:e}})).then(n)},renderHandler:function(t){return"top"===t?a:"bottom"===t?r:void 0},setupHandler:function(t){try{if(t)return n("1868bfa5")("./".concat(t,"/main"))}catch(t){return}},handleError:function(t){throw console.error(t),t}}},"2e48b3ec":function(t,e){t.exports=function(t,e){var n=t.messageElement.querySelector(".o-message__actions"),o=t.messageElement.querySelector(".o-message__actions__primary");n.className+=" o-message__actions--clickarea",n.addEventListener("click",(function(t){if(t.target!==o)return t.stopPropagation(),o.click(),!1})),e()}},"33a19ecd":function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return l}));var o=n("616ba185"),a=n("dcfa7677"),r=n("33cab54f"),i=n("99a4eb02"),c=n.n(i),s=document.querySelector(".topper__primary-theme .n-myft-follow-button"),u=c.a.get("FT_MyFT_article_tooltip")||0;function l(t,e){!s||u>=3||a.default.init([{relationship:"followed",type:"concept"}]).then((function(){return a.default.getAll("followed","concept")})).then((function(e){return function(t,e){if(t.length>0)return;var n=document.querySelector(".topper__primary-theme .js-primary-theme").innerText,a=["Find ".concat(n," stories easily."),"Start your feed."].map((function(t){return'<span style="display: block">'.concat(t,"</span>")})).join(" ");Object(r.broadcast)("oTracking.event",{action:"criteria-met",category:"myft-disengaged-tooltip",detail:{type:"article-page-about-tooltip",followedConceptCount:0}});var i=new o.default(s,{target:"myft-disengaged-tooltip",content:a,showOnConstruction:!0,position:"below"});u++,c.a.set("FT_MyFT_article_tooltip",u,{expires:365,path:"/content"}),i.tooltipEl.addEventListener("oTooltip.close",(function(){return e.close()}))}(e,t)})).finally((function(){return e()}))}},"4acd4fb0":function(t,e,n){t.exports={nMessagingClient:n("2b5e386d")}},"4b589924":function(t,e,n){"use strict";function o(t,e,n){n.renderData.remainingArticles<0||e()}n.r(e),n.d(e,"default",(function(){return o}))},"7785725b":function(t,e,n){var o=n("7d373a79");t.exports=function(t,e){return o(t,e)}},"7d373a79":function(t,e,n){var o=n("99a4eb02");t.exports=function(t,e){return void 0===o.get("popupPromptShown")&&t.open(),t.bannerElement.querySelector(".o-banner__close").addEventListener("click",(function(){var t=new Date((new Date).getTime()+864e6);o.set("popupPromptShown","OK",{domain:"ft.com",expires:t})})),e({skip:!0})}},"82da35ea":function(t,e,n){var o=n("81804e5c").default,a=n("03f4cdb1"),r=a.generateMessageEvent,i=a.listen;t.exports=function(t){var e=r({flag:"messageSlotBottom",messageId:t.name,position:t.slot,trackingContext:t.trackingContext||{},variant:t.name});i(document.documentElement,"oCookieMessage.close",(function(){return e("close")})),i(document.documentElement,"oCookieMessage.view",(function(){return e("view")})),o.init(),document.querySelectorAll("[data-n-messaging-policy],[data-n-messaging-manage-cookies],[data-n-messaging-accept-cookies]").forEach((function(t){i(t,"click",(function(){return e("act",t.textContent.trim())}))}))}},"96f50564":function(t,e){function n(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,i=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}t.exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.guruEndpoint,o=void 0===e?"/__message":e,a=t.name,r=t.guruQueryString,i="".concat(o,"/").concat(a).concat(r?"?"+r:""),c={method:"GET",headers:{Accept:"application/json","FT-Skip-Cache":"Yes"},credentials:"same-origin"},s=function(t){if(!t.skip&&t.data&&t.renderData)return!0;throw new Error("Bad response body")};return fetch(i,c).then((function(t){if(200===t.status)return t.json();t.text().then((function(t){throw new Error("Bad response status ".concat(status,": ").concat(t))}))})).then((function(t){return(t.skip||s(t))&&t})).then((function(t){var e=["myft","product","marketing","slate-background"],o=["small","compact"];if(t.renderData.customThemes=[],t&&t.renderData&&Array.isArray(t.renderData.theme)){var a,r=n(t.renderData.theme);try{for(r.s();!(a=r.n()).done;){var i=a.value;e.includes(i)?t.renderData.bannerTheme=i:o.includes(i)?t.renderData.bannerLayout=i:t.renderData.customThemes.push(i)}}catch(t){r.e(t)}finally{r.f()}}return t})).catch((function(){return!1}))}},"9b6503ab":function(t,e,n){var o=n("93f629c6");o=o.default||o;var a=n("03f4cdb1"),r=a.generateMessageEvent,i=a.listen,c=a.messageEventLimitsBreached,s=".".concat("o-message","__button"),u=".".concat("o-message","__link");function l(t,e){return!t.lazy&&t.content||t.lazy&&e&&e.renderData&&e.renderData.reservedSpace?t.content:null}function p(t,e,n){return{autoOpen:t.autoOpen||e.autoOpen,messageClass:t.messageClass||e.messageClass,type:t.type||e.type,parentElement:n.lazy?t.parentElement||'[data-n-messaging-slot="top"] [data-n-messaging-component]':null,content:{highlight:t.contentTitle,detail:t.content,additionalInfo:t.additionalInfo},actions:{primary:{text:t.buttonLabel,url:t.buttonUrl,openInNewWindow:t.openInNewWindow},secondary:{text:t.linkLabel,url:t.linkUrl}},customTrackingEvent:t.customTrackingEvent,close:t.closeButton,dynamicTrackingData:t.dynamicTrackingData,state:t.state||e.state}}t.exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.config,n=void 0===e?{}:e,a=t.guruResult,m=t.customSetup,g=a&&a.renderData&&a.renderData.dynamicTrackingData||n.name,f=r({flag:"messageSlotTop",messageId:n.name,position:n.slot,trackingContext:n.trackingContext,variant:g}),d=l(n,a),b={messageClass:"o-message",autoOpen:!1,openInNewWindow:!1,close:o.getDataAttributes(d).close,type:"notice",state:"skip"};if(a&&a.skip&&f)f("skip");else{var y=a&&a.renderData||{},v=p(y,b,n),h=new o(d,v);if(c(n.name))f("skip");else{var k=void 0!==v.customTrackingEvent,E=h.messageElement.querySelectorAll("[data-o-message-action]");if(0!==E.length||k){if(k){var S=h.messageElement.querySelector(".o-message__actions__primary");S&&(S.setAttribute("data-n-alert-banner-action",v.customTrackingEvent),E=[S])}}else 0===(E=h.messageElement.querySelectorAll(s)).length&&(E=h.messageElement.querySelectorAll(u));if(E=[].slice.call(E),i(h.messageElement,"o.messageClosed",(function(){return f("close")})),i(h.messageElement,"o.messageOpen",(function(){return f("view")})),E&&E.length>0&&E.forEach((function(t){var e=t.dataset.nAlertBannerActionType;i(t,"click",(function(){return f(t.dataset.nAlertBannerAction||"act",e)}))})),m){var _=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.skip,n=void 0!==e&&e;n?f("skip"):h.open()};m.default&&(m=m.default),m(h,_,a)}else h.open()}}}},"9db0abe7":function(t,e,n){var o=n("7d373a79");t.exports=function(t,e){return o(t,e)}},ab1d36c6:function(t,e){t.exports=function(t,e){Array.from(t.bannerElement.querySelectorAll(".n-messaging-client-messaging-banner-post-activation-journey__action")).forEach((function(e){e.addEventListener("click",(function(e){"leave-feedback"===e.target.name?t.bannerElement.parentNode.removeChild(t.bannerElement):t.close()}))})),e()}},b88707c7:function(t,e,n){function o(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var i=n("2264684a");i=i.default||i;var c=n("03f4cdb1"),s=c.generateMessageEvent,u=c.listen,l=c.messageEventLimitsBreached,p=".".concat("o-banner","__button"),m=".".concat("o-banner","__link");function g(t,e){var n=t.innerElement.querySelectorAll("[data-n-messaging-banner-action]"),a=[];0===n.length&&(n=t.innerElement.querySelectorAll(p),a=t.innerElement.querySelectorAll(m)),n=[].concat(o(n),o(a)),u(t.bannerElement,"o.bannerClosed",(function(){return e("close")})),u(t.bannerElement,"o.bannerOpened",(function(){return e("view")})),n&&n.length>0&&n.forEach((function(t){var n=t.dataset.nMessagingBannerActionType,o=t.textContent;u(t,"click",(function(){return e(t.dataset.nMessagingBannerAction||"act",n||o)}))}))}function f(t){var e={autoOpen:t.autoOpen||!1,suppressCloseButton:t.suppressCloseButton||!1,bannerClass:t.bannerClass||"o-banner",theme:t.bannerTheme,layout:t.bannerLayout,formEncoding:t.formEncoding,formMethod:t.formMethod,formAction:t.formAction,contentLong:t.contentLong,contentShort:t.contentShort,buttonLabel:t.buttonLabel,buttonUrl:t.buttonUrl,linkLabel:t.linkLabel,linkUrl:t.linkUrl,appendTo:'[data-n-messaging-slot="bottom"] [data-n-messaging-component]',dynamicTrackingData:t.dynamicTrackingData},n=new i(null,e);if(n.bannerElement.classList.add("n-messaging-client-messaging-banner"),Array.isArray(t.customThemes)){var o,r=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,i=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}(t.customThemes);try{for(r.s();!(o=r.n()).done;){var c=o.value;n.bannerElement.classList.add("".concat("n-messaging-client-messaging-banner","--").concat(c))}}catch(t){r.e(t)}finally{r.f()}}return n}function d(t,e){var n=e.dynamicTrackingData||t.name,o=Object.assign(t.trackingContext||{},e.trackingContext||{});return s({flag:"messageSlotBottom",messageId:t.name,position:t.slot,trackingContext:o,variant:n})}t.exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.config,n=void 0===e?{}:e,o=t.guruResult,a=t.customSetup,r=o&&o.renderData||{},c=d(n,r),s=o&&o.skip,u=l(n.name);if(s||u)c("skip");else{var p=!n.lazy&&n.content,m=o&&o.renderData,b=!p&&!m;if(!b){var y=p?new i(p):f(r);if(g(y,c),a){var v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.skip,n=void 0!==e&&e;n?c("skip"):y.open()};(a=a.default||a)(y,v,o,c)}else y.open()}}}},b8ca0b2d:function(t,e){t.exports=function(t,e){Array.from(t.bannerElement.querySelectorAll(".n-messaging-client-messaging-banner--customer-care-call__book-now-action")).forEach((function(e){e.addEventListener("click",(function(e){"book-now"===e.target.name?t.bannerElement.parentNode.removeChild(t.bannerElement):t.close()}))})),e()}}}]);
//# sourceMappingURL=n-messaging-client.c83586c2fdb9.bundle.js.map