(window.webpackJsonp=window.webpackJsonp||[]).push([["n-feedback"],{"038b8f1d":function(t,e){t.exports=function(t){var e=document,n=e.referrer,r=e.URL,a=t.appName,o=t.product,c=t.version,i=t.nativeAppVersion,s=t.domain,d={appName:a||t.name,currentUrl:r,referrerUrl:n,product:o,version:c,domain:s};return i&&(d.nativeAppVersion=i),d}},"1c5be40c":function(t,e,n){var r=n("20ee13ff").default,a=n("d4400cb8"),o=n("d4f6402f"),c=n("038b8f1d"),i=n("6fc56ae0");function s(t){var e="https://www.ft.com/__feedback-api/v1/survey/".concat(t);return fetch(e,{headers:{Accept:"application/json"}}).then((function(t){return 200!==t.status&&t.text().then((function(t){throw new Error("Bad response status ".concat(status,": ").concat(t))})),t.json()}))}function d(t,e,n,r){var a=t.content,i=r.containerSelector,s=void 0===i?"body":i;document.querySelectorAll(".n-feedback__survey-next,.n-feedback__survey-back",a).forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var n="."+e.target.getAttribute("data-survey-next");u(t,n)}),!0)}));var d=document.querySelector(".n-feedback__survey__wrapper-form",a);d&&d.addEventListener("submit",(function(a){a.preventDefault();var i=function(t){var e=t.content,n=document.querySelector(".n-feedback__survey__wrapper-form",e),r={};return n.querySelectorAll("input,textarea").forEach((function(t){"radio"===t.type?t.checked&&(r[t.name]=t.value):"checkbox"===t.type?t.checked&&(r[t.name]=(r[t.name]||[]).concat(t.value)):r[t.name]=t.value})),r}(t),d=c(r);u(t,".feedback-overlay__loader-wrapper"),o(n,e,i,d).then((function(){u(t,".n-feedback__survey-block-finished"),t.wrapper.addEventListener("oOverlay.destroy",(function(){!function(t){document.querySelector("".concat(t," .n-feedback__container")).classList.add("n-feedback--hidden")}(s)}))})).catch((function(e){console.error("Failed to post form",e),t.close()}))})),a&&a.addEventListener("change",(function(t){l(t.target.closest(".n-feedback__survey-block"))}))}function u(t,e){var n=t.content,r=document.querySelector(e,n),a=document.querySelectorAll(".n-feedback__survey-block",n);l(r),a.forEach((function(t){return t.classList.add("n-feedback--hidden")})),r.classList.remove("n-feedback--hidden")}function l(t){var e=document.querySelector(".n-feedback__survey-next",t);return function(t){var e=document.querySelectorAll('[data-validation="true"]',t);return 0===Array.prototype.slice.call(e).filter((function(t){if(t.classList.contains("n-feedback__question-radio")){var e=document.querySelectorAll('input[type="radio"]',t);return 0===Array.prototype.slice.call(e).filter((function(t){return t.checked})).length}})).length}(t)?(e.removeAttribute("disabled"),!0):(e.setAttribute("disabled","disabled"),!1)}function f(t){t[t.visible?"close":"open"]()}function b(t,e){var n=i[e].formHead;t.innerHTML='<div class="n-feedback__overlay__container"></div>\n\t\t<p class="n-feedback__desktop__prompt">\n\t\t\t'.concat(n,'\n\t\t</p>\n\t\t<button class="n-feedback__survey-trigger" aria-label="Give feedback on the Financial Times website" data-trackable="feedback-start">\n\t\t\t<span>Feedback</span>\n\t\t</button>')}var v=function(t){return t.domain||(t.domain="FT.com"),t.containerSelector||(t.containerSelector="body"),t};t.exports.init=function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o="SV_9mBFdO5zpERO0cZ",c=v(n),i=c.containerSelector,u=c.domain,p=document.querySelector("".concat(i," .n-feedback__container"));p.classList.remove("n-feedback--hidden"),b(p,u);var _=document.querySelector("".concat(i," .n-feedback__container .n-feedback__survey-trigger")),y="feedback-overlay-".concat(i);return _&&_.addEventListener("click",(function(){e||(e=new r(y,{html:'<div class="feedback-overlay__loader-wrapper"><div class="o-loading o-loading--dark o-loading--large"></div></div>',fullscreen:!0,class:"feedback-overlay",zindex:1001,customclose:".n-feedback__survey__close-button"})),t||s(o).then((function(r){if(!r||r&&0===r.length)console.error("Bad survey data");else{t=r;var c=a.buildSurvey(t,o,u);e.visible||e.open(),e.content.innerHTML=c,d(e,t,o,n),l(document.querySelectorAll(".n-feedback__survey-block",e.content)[0])}})).catch((function(t){e.destroy(),p.classList.add("n-feedback--hidden"),_.classList.add("n-feedback--hidden"),console.error("Failed to get survey data",t)})),f(e)}),!0),{destroy:function(){e&&e.destroy()}}}},"1ea050fd":function(t,e){function n(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}t.exports=function(t){var e,r=t.filter((function(t){return t.questions&&t.questions.length>0}));return(e=[]).concat.apply(e,n(r.map((function(t){return t.questions})))).map((function(t){return{id:t.questionId,text:t.questionText}}))}},"6fc56ae0":function(t,e){t.exports={app:{formHead:"How easy or hard was it to use the FT app today?"},"FT.com":{formHead:"How easy or hard was it to use FT.com today?"}}},d4400cb8:function(t,e,n){function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){a=!0,o=t}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var o=n("6fc56ae0");function c(t){return'<div class="n-feedback__center-block"><h2 class="n-feedback__question-header">'.concat(t.questionText,"</h2></div>")}function i(t){return'<p class="n-feedback__question-text">'.concat(t.questionText,"</p>")}function s(t){return'<div class="n-feedback__center-block"><p class="n-feedback__question-footer">'.concat(t.questionText,"</p></div>")}function d(t){var e={MC:u,TE:l},n=t.questionType.type;return n in e?e[n](t):""}function u(t){var e=t.validation.doesForceResponse,n=['<fieldset class="n-feedback__question-radio" data-validation='.concat(e,">\n\t\t\t<legend>").concat(t.questionText,'</legend>\n\t\t\t<div class="n-feedback__center-block">\n\t\t\t<div class="o-forms-field">\n\t\t\t')];return Object.entries(t.choices).reverse().forEach((function(e){var a=r(e,2),o=a[0],c=a[1],i="choice-".concat(o,"-").concat(~~(65535*Math.random()));n.push('\n\t\t\t<div class="o-forms-input o-forms-input--radio-round">\n\t\t\t\t<input type="radio" id="'.concat(i,'" name="').concat(t.questionId,'" value="').concat(o,'" />\n\t\t\t\t<label for="').concat(i,'" class="o-forms-input__label">\n\t\t\t\t\t').concat(c.choiceText,"\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t"))})),n.push("</div></div></fieldset>"),n.join("\n")}function l(t){var e="text-".concat(t.questionId,"-").concat(~~(65535*Math.random()));return'<div class="n-feedback__center-block">\n\t\t\t<div class="n-feedback__question-text-entry o-forms">\n\t\t\t\t<div class="o-forms-field">\n\t\t\t\t\t<label for="'.concat(e,'" class="o-forms-label">\n\t\t\t\t\t\t<span class="o-forms-title">\n\t\t\t\t\t\t\t<span class="o-forms-title__main">').concat(t.questionText,'</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div class="o-forms-input o-forms-input--textarea">\n\t\t\t\t\t\t\t<textarea id="').concat(e,'" name="').concat(t.questionId,'" rows="8"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t')}t.exports={buildSurvey:function(t,e,n){var r={header:c,footer:s,text:i,question:d},a=['<div class="n-feedback__survey" aria-live="assertive">\n\t\t\t<a class="n-feedback__survey__close-button o-overlay__close" href="#void">\n\t\t\t\t<span>I don\'t want to give feedback</span>\n\t\t\t</a>\n\t\t\t<form class="n-feedback__survey__wrapper-form">\n\t\t\t\t<input type="hidden" name="surveyId" value="'.concat(e,'" />')];t.forEach((function(e,c){var i=['<div class="n-feedback__survey-block '.concat(0===c?"":"n-feedback--hidden"," n-feedback__survey-block-").concat(c,'">')];e.questions.forEach((function(t){"How easy or hard was it to use FT.com today?"===t.questionText.trim()&&"app"===n&&(t.questionText=o[n].formHead);var e=t.questionName.toLowerCase();if(e in r){var a=r[e](t);i.push(a)}})),i.push(function(t,e){var n=[];return n.push('<div class="n-feedback__center-block"><p class="n-feedback__survey__button-bar">'),e>0&&n.push('<button class="n-feedback__primary-button n-feedback__survey-back"\n\t\t\t\tdata-survey-next="n-feedback__survey-block-'.concat(e-1,'"\n\t\t\t\tdata-trackable="feedback-previous-block">\n\t\t\t\tBack\n\t\t\t</button>')),t-1>e?n.push('<button class="n-feedback__primary-button n-feedback__survey-next"\n\t\t\t\tdata-survey-next="n-feedback__survey-block-'.concat(e+1,'"\n\t\t\t\tdata-trackable="feedback-next-block">\n\t\t\t\tNext\n\t\t\t</button>')):n.push('<button class="n-feedback__primary-button n-feedback__survey-submit"\n\t\t\t\tdata-trackable="feedback-submit">\n\t\t\t\tSubmit\n\t\t\t</button>'),n.push("</p></div>"),n.join("\n")}(t.length,c)),i.push("</div>"),a.push(i.join("\n"))})),a.push("</form>"),a.push('<div class="n-feedback__survey-block feedback-overlay__loader-wrapper n-feedback--hidden"><div class="o-loading o-loading--dark o-loading--large"></div></div>');var u=t.map((function(t){return t.questions.find((function(t){return"Text"===t.questionName}))}))[0];return a.push('<div class="n-feedback__survey-block n-feedback--hidden n-feedback__survey-block-finished">\n\t\t\t'.concat(c({questionText:"Thanks for your feedback"}),"\n\n\t\t\t").concat(u?s(u):"",'\n\n\t\t\t<div class="n-feedback__center-block"><p class="n-feedback__survey__button-bar">\n\t\t\t\t<button class="n-feedback__primary-button o-overlay__close">\n\t\t\t\t\tClose\n\t\t\t\t</button>\n\t\t</div>')),a.push("</div>"),a.join("\n")}}},d4f6402f:function(t,e,n){var r=n("1ea050fd");t.exports=function(t,e,n,a){var o={surveyId:t,surveyResponse:r(e).map((function(t){return{id:t.id,text:t.text,response:n[t.id]||""}})),additionalData:a},c={credentials:"include",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)};return fetch("".concat("https://www.ft.com/__feedback-api/v1","/survey"),c)}}}]);
//# sourceMappingURL=n-feedback.660bffa3ce99.bundle.js.map