var buildUSLink=function(){var n=window.location.href;n.match(/\?/)?window.location.search?n+="&intl=nosplash":n+="intl=nosplash":n+="?intl=nosplash",$(".us-link").attr("href",n),$(".us-link").on("click",function(){window.location.href=n})},languageMenu=function(){var n=navigator.language.substring(0,2),e="en";"en"===n?e="en":"fr"===n?e="fr":"es"===n&&(e="es");var t=function(n){$(".language-menu button").removeClass("is-active"),$('.language-menu button[lang="'+n+'"]').addClass("is-active"),$(".content [lang]").addClass("hidden"),$('.content [lang="'+n+'"]').removeClass("hidden")};$(".language-menu").on("click","button",function(){e=$(this).prop("lang"),t(e),buildCanadaLink()}),t(e)},countrySelection=function(){$(".country-selection").on("click","a",function(){!function(n,e,t){var a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3);var i="expires="+a.toUTCString();document.cookie=n+"="+e+";"+i+";path=/"}("intl_splash",!1,3)})},getRedirectJson=async function(){try{const n=await fetch("https://www.bestbuy.ca/bbyus-redirect-map/map.json");return await n.json().then(n=>n)}catch(n){return console.log(`There was an error with the fetch ${error}`),[]}},buildCanadaLink=async function(){const n=await getRedirectJson(),e="fr"===$(".language-menu .is-active")[0].lang?"fr":"en",t="fr"===e?"caFrPage":"caEnPage",a="https://www.bestbuy.ca/"+e+"-CA/home.aspx",i=document.referrer,o=window.location.href;let c=a+"?intlreferer="+i+"&intlredir="+o;const r=n.findIndex(n=>n.usPage===o);r>-1&&(c=n[r][t]+"?intlreferer="+i+"&intlredir="+o),$(".canada-link").on("click",function(){window.location.href=c})};window.onload=function(){languageMenu(),countrySelection(),buildUSLink(),buildCanadaLink()};